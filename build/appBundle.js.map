{"version":3,"file":"appBundle.js","sources":["../node_modules/@lightningjs/sdk/src/Settings/index.js","../node_modules/@lightningjs/sdk/src/Log/index.js","../node_modules/@michieljs/execute-as-promise/src/execute-as-promise.js","../node_modules/@lightningjs/sdk/src/Metrics/index.js","../node_modules/@lightningjs/sdk/src/VideoPlayer/events.js","../node_modules/@lightningjs/sdk/src/helpers/autoSetupMixin.js","../node_modules/@lightningjs/sdk/src/helpers/easeExecution.js","../node_modules/@lightningjs/sdk/src/Utils/index.js","../node_modules/@lightningjs/sdk/src/Profile/index.js","../../../../../../usr/local/lib/node_modules/@lightningjs/cli/src/alias/lightningjs-core.js","../node_modules/@lightningjs/sdk/src/Lightning/index.js","../node_modules/@lightningjs/sdk/src/MediaPlayer/index.js","../node_modules/localCookie/module/localCookie.js","../node_modules/@lightningjs/sdk/src/Storage/index.js","../node_modules/@lightningjs/sdk/src/Router/utils/regex.js","../node_modules/@lightningjs/sdk/src/Router/utils/register.js","../node_modules/@lightningjs/sdk/src/Router/model/Request.js","../node_modules/@lightningjs/sdk/src/Router/model/Route.js","../node_modules/@lightningjs/sdk/src/Router/utils/route.js","../node_modules/@lightningjs/sdk/src/Router/utils/emit.js","../node_modules/@lightningjs/sdk/src/Router/utils/widgets.js","../node_modules/@lightningjs/sdk/src/Router/utils/components.js","../node_modules/@lightningjs/sdk/src/Router/utils/history.js","../node_modules/deepmerge/dist/cjs.js","../node_modules/@lightningjs/sdk/src/Locale/index.js","../node_modules/@lightningjs/sdk/src/VersionLabel/index.js","../node_modules/@lightningjs/sdk/src/FpsCounter/index.js","../node_modules/@lightningjs/sdk/src/Language/index.js","../node_modules/@lightningjs/sdk/src/Registry/index.js","../node_modules/@lightningjs/sdk/src/Colors/utils.js","../node_modules/@lightningjs/sdk/src/Colors/index.js","../node_modules/@lightningjs/sdk/src/Application/index.js","../node_modules/@lightningjs/sdk/src/Router/utils/router.js","../node_modules/@lightningjs/sdk/src/Router/utils/helpers.js","../node_modules/@lightningjs/sdk/src/Router/utils/provider.js","../node_modules/@lightningjs/sdk/src/Router/transitions.js","../node_modules/@lightningjs/sdk/src/Router/utils/transition.js","../node_modules/@lightningjs/sdk/src/Router/utils/loader.js","../node_modules/@lightningjs/sdk/src/Router/base.js","../node_modules/@lightningjs/sdk/src/Router/index.js","../node_modules/@lightningjs/sdk/src/TV/defaults.js","../node_modules/@lightningjs/sdk/src/TV/index.js","../node_modules/@lightningjs/sdk/src/Purchase/index.js","../node_modules/@lightningjs/sdk/src/Pin/dialog.js","../node_modules/@lightningjs/sdk/src/Pin/index.js","../node_modules/@lightningjs/sdk/src/Launch/index.js","../node_modules/@lightningjs/sdk/src/VideoPlayer/VideoTexture.js","../node_modules/@lightningjs/sdk/src/VideoPlayer/index.js","../node_modules/@lightningjs/sdk/src/Ads/index.js","../node_modules/@lightningjs/sdk/src/Img/ScaledImageTexture.js","../src/screens/BaseScreen/index.js","../src/screens/HomeScreen/index.js","../src/screens/MoviesScreen/index.js","../src/screens/TVShowsScreen/index.js","../src/screens/SportsScreen/index.js","../src/lib/RoutingMap.js","../src/lib/Router.js","../src/lib/NavigationItem.js","../src/components/Header/HeaderItem.js","../src/components/Header/Header.js","../src/components/Slider/Slider.js","../src/components/Movies/Movies.js","../src/App.js","../src/index.js"],"sourcesContent":["/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst settings = {}\nconst subscribers = {}\n\nexport const initSettings = (appSettings, platformSettings) => {\n  settings['app'] = appSettings\n  settings['platform'] = platformSettings\n  settings['user'] = {}\n}\n\nconst publish = (key, value) => {\n  subscribers[key] && subscribers[key].forEach(subscriber => subscriber(value))\n}\n\nconst dotGrab = (obj = {}, key) => {\n  if (obj === null) return undefined\n  const keys = key.split('.')\n  for (let i = 0; i < keys.length; i++) {\n    obj = obj[keys[i]] = obj[keys[i]] !== undefined ? obj[keys[i]] : {}\n  }\n  return typeof obj === 'object' && obj !== null ? (Object.keys(obj).length ? obj : undefined) : obj\n}\n\nexport default {\n  get(type, key, fallback = undefined) {\n    const val = dotGrab(settings[type], key)\n    return val !== undefined ? val : fallback\n  },\n  has(type, key) {\n    return !!this.get(type, key)\n  },\n  set(key, value) {\n    settings['user'][key] = value\n    publish(key, value)\n  },\n  subscribe(key, callback) {\n    subscribers[key] = subscribers[key] || []\n    subscribers[key].push(callback)\n  },\n  unsubscribe(key, callback) {\n    if (callback) {\n      const index = subscribers[key] && subscribers[key].findIndex(cb => cb === callback)\n      index > -1 && subscribers[key].splice(index, 1)\n    } else {\n      if (key in subscribers) {\n        subscribers[key] = []\n      }\n    }\n  },\n  clearSubscribers() {\n    for (const key of Object.getOwnPropertyNames(subscribers)) {\n      delete subscribers[key]\n    }\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings'\n\nconst prepLog = (type, args) => {\n  const colors = {\n    Info: 'green',\n    Debug: 'gray',\n    Warn: 'orange',\n    Error: 'red',\n  }\n\n  args = Array.from(args)\n  return [\n    '%c' + (args.length > 1 && typeof args[0] === 'string' ? args.shift() : type),\n    'background-color: ' + colors[type] + '; color: white; padding: 2px 4px; border-radius: 2px',\n    args,\n  ]\n}\n\nexport default {\n  info() {\n    Settings.get('platform', 'log') && console.log.apply(console, prepLog('Info', arguments))\n  },\n  debug() {\n    Settings.get('platform', 'log') && console.debug.apply(console, prepLog('Debug', arguments))\n  },\n  error() {\n    Settings.get('platform', 'log') && console.error.apply(console, prepLog('Error', arguments))\n  },\n  warn() {\n    Settings.get('platform', 'log') && console.warn.apply(console, prepLog('Warn', arguments))\n  },\n}\n","export default (method, args = null, context = null) => {\n  let result\n  if (method && typeof method === 'function') {\n    try {\n      result = method.apply(context, args)\n    } catch (e) {\n      result = e\n    }\n  } else {\n    result = method\n  }\n\n  // if it looks like a duck .. ehm ... promise and talks like a promise, let's assume it's a promise\n  if (\n    result !== null &&\n    typeof result === 'object' &&\n    result.then &&\n    typeof result.then === 'function'\n  ) {\n    return result\n  }\n  // otherwise make it into a promise\n  else {\n    return new Promise((resolve, reject) => {\n      if (result instanceof Error) {\n        reject(result)\n      } else {\n        resolve(result)\n      }\n    })\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../Log'\n\nlet sendMetric = (type, event, params) => {\n  Log.info('Sending metric', type, event, params)\n}\n\nexport const initMetrics = config => {\n  sendMetric = config.sendMetric\n}\n\n// available metric per category\nconst metrics = {\n  app: ['launch', 'loaded', 'ready', 'close'],\n  page: ['view', 'leave'],\n  user: ['click', 'input'],\n  media: [\n    'abort',\n    'canplay',\n    'ended',\n    'pause',\n    'play',\n    // with some videos there occur almost constant suspend events ... should investigate\n    // 'suspend',\n    'volumechange',\n    'waiting',\n    'seeking',\n    'seeked',\n  ],\n}\n\n// error metric function (added to each category)\nconst errorMetric = (type, message, code, visible, params = {}) => {\n  params = { params, ...{ message, code, visible } }\n  sendMetric(type, 'error', params)\n}\n\nconst Metric = (type, events, options = {}) => {\n  return events.reduce(\n    (obj, event) => {\n      obj[event] = (name, params = {}) => {\n        params = { ...options, ...(name ? { name } : {}), ...params }\n        sendMetric(type, event, params)\n      }\n      return obj\n    },\n    {\n      error(message, code, params) {\n        errorMetric(type, message, code, params)\n      },\n      event(name, params) {\n        sendMetric(type, name, params)\n      },\n    }\n  )\n}\n\nconst Metrics = types => {\n  return Object.keys(types).reduce(\n    (obj, type) => {\n      // media metric works a bit different!\n      // it's a function that accepts a url and returns an object with the available metrics\n      // url is automatically passed as a param in every metric\n      type === 'media'\n        ? (obj[type] = url => Metric(type, types[type], { url }))\n        : (obj[type] = Metric(type, types[type]))\n      return obj\n    },\n    { error: errorMetric, event: sendMetric }\n  )\n}\n\nexport default Metrics(metrics)\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default {\n  abort: 'Abort',\n  canplay: 'CanPlay',\n  canplaythrough: 'CanPlayThrough',\n  durationchange: 'DurationChange',\n  emptied: 'Emptied',\n  encrypted: 'Encrypted',\n  ended: 'Ended',\n  error: 'Error',\n  interruptbegin: 'InterruptBegin',\n  interruptend: 'InterruptEnd',\n  loadeddata: 'LoadedData',\n  loadedmetadata: 'LoadedMetadata',\n  loadstart: 'LoadStart',\n  pause: 'Pause',\n  play: 'Play',\n  playing: 'Playing',\n  progress: 'Progress',\n  ratechange: 'Ratechange',\n  seeked: 'Seeked',\n  seeking: 'Seeking',\n  stalled: 'Stalled',\n  // suspend: 'Suspend', // this one is called a looooot for some videos\n  timeupdate: 'TimeUpdate',\n  volumechange: 'VolumeChange',\n  waiting: 'Waiting',\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default (sourceObject, setup = () => {}) => {\n  let ready = false\n\n  const doSetup = () => {\n    if (ready === false) {\n      setup()\n      ready = true\n    }\n  }\n\n  return Object.keys(sourceObject).reduce((obj, key) => {\n    if (typeof sourceObject[key] === 'function') {\n      obj[key] = function() {\n        doSetup()\n        return sourceObject[key].apply(sourceObject, arguments)\n      }\n    } else if (typeof Object.getOwnPropertyDescriptor(sourceObject, key).get === 'function') {\n      obj.__defineGetter__(key, function() {\n        doSetup()\n        return Object.getOwnPropertyDescriptor(sourceObject, key).get.apply(sourceObject)\n      })\n    } else if (typeof Object.getOwnPropertyDescriptor(sourceObject, key).set === 'function') {\n      obj.__defineSetter__(key, function() {\n        doSetup()\n        return Object.getOwnPropertyDescriptor(sourceObject, key).set.sourceObject[key].apply(\n          sourceObject,\n          arguments\n        )\n      })\n    } else {\n      obj[key] = sourceObject[key]\n    }\n    return obj\n  }, {})\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet timeout = null\n\nexport default (cb, delay) => {\n  clearTimeout(timeout)\n  timeout = setTimeout(() => {\n    cb()\n  }, delay)\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet basePath\nlet proxyUrl\n\nexport const initUtils = config => {\n  basePath = ensureUrlWithProtocol(makeFullStaticPath(window.location.pathname, config.path || '/'))\n\n  if (config.proxyUrl) {\n    proxyUrl = ensureUrlWithProtocol(config.proxyUrl)\n  }\n}\n\nexport default {\n  asset(relPath) {\n    return basePath + relPath\n  },\n  proxyUrl(url, options = {}) {\n    return proxyUrl ? proxyUrl + '?' + makeQueryString(url, options) : url\n  },\n  makeQueryString() {\n    return makeQueryString(...arguments)\n  },\n  // since imageworkers don't work without protocol\n  ensureUrlWithProtocol() {\n    return ensureUrlWithProtocol(...arguments)\n  },\n}\n\nexport const ensureUrlWithProtocol = url => {\n  if (/^\\/\\//.test(url)) {\n    return window.location.protocol + url\n  }\n  if (!/^(?:https?:)/i.test(url)) {\n    return window.location.origin + url\n  }\n  return url\n}\n\nexport const makeFullStaticPath = (pathname = '/', path) => {\n  // ensure path has traling slash\n  path = path.charAt(path.length - 1) !== '/' ? path + '/' : path\n\n  // if path is URL, we assume it's already the full static path, so we just return it\n  if (/^(?:https?:)?(?:\\/\\/)/.test(path)) {\n    return path\n  }\n\n  if (path.charAt(0) === '/') {\n    return path\n  } else {\n    // cleanup the pathname (i.e. remove possible index.html)\n    pathname = cleanUpPathName(pathname)\n\n    // remove possible leading dot from path\n    path = path.charAt(0) === '.' ? path.substr(1) : path\n    // ensure path has leading slash\n    path = path.charAt(0) !== '/' ? '/' + path : path\n    return pathname + path\n  }\n}\n\nexport const cleanUpPathName = pathname => {\n  if (pathname.slice(-1) === '/') return pathname.slice(0, -1)\n  const parts = pathname.split('/')\n  if (parts[parts.length - 1].indexOf('.') > -1) parts.pop()\n  return parts.join('/')\n}\n\nconst makeQueryString = (url, options = {}, type = 'url') => {\n  // add operator as an option\n  options.operator = 'metrological' // Todo: make this configurable (via url?)\n  // add type (= url or qr) as an option, with url as the value\n  options[type] = url\n\n  return Object.keys(options)\n    .map(key => {\n      return encodeURIComponent(key) + '=' + encodeURIComponent('' + options[key])\n    })\n    .join('&')\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings'\nimport { defaultProfile } from './defaults'\n\nlet getInfo = key => {\n  const profile = { ...defaultProfile, ...Settings.get('platform', 'profile') }\n  return Promise.resolve(typeof profile[key] === 'function' ? profile[key]() : profile[key])\n}\n\nlet setInfo = (key, params) => {\n  if (key in defaultProfile) defaultProfile[key] = params\n}\n\nexport const initProfile = config => {\n  getInfo = config.getInfo\n  setInfo = config.setInfo\n}\n\nconst getOrSet = (key, params) => (params ? setInfo(key, params) : getInfo(key))\n\n// public API\nexport default {\n  ageRating(params) {\n    return getOrSet('ageRating', params)\n  },\n  city(params) {\n    return getOrSet('city', params)\n  },\n  zipCode(params) {\n    return getOrSet('zipCode', params)\n  },\n  countryCode(params) {\n    return getOrSet('countryCode', params)\n  },\n  ip(params) {\n    return getOrSet('ip', params)\n  },\n  household(params) {\n    return getOrSet('household', params)\n  },\n  language(params) {\n    return getOrSet('language', params)\n  },\n  latlon(params) {\n    return getOrSet('latlon', params)\n  },\n  locale(params) {\n    return getOrSet('locale', params)\n  },\n  mac(params) {\n    return getOrSet('mac', params)\n  },\n  operator(params) {\n    return getOrSet('operator', params)\n  },\n  platform(params) {\n    return getOrSet('platform', params)\n  },\n  packages(params) {\n    return getOrSet('packages', params)\n  },\n  uid(params) {\n    return getOrSet('uid', params)\n  },\n  stbType(params) {\n    return getOrSet('stbType', params)\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default window.lng\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '@lightningjs/core'\nexport default Lightning\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../Lightning'\nimport Metrics from '../Metrics'\nimport Settings from '../Settings'\nimport Log from '../Log'\n\nconst events = [\n  'timeupdate',\n  'error',\n  'ended',\n  'loadeddata',\n  'canplay',\n  'play',\n  'playing',\n  'pause',\n  'loadstart',\n  'seeking',\n  'seeked',\n  'encrypted',\n]\n\nlet mediaUrl = url => url\n\nexport const initMediaPlayer = config => {\n  if (config.mediaUrl) {\n    mediaUrl = config.mediaUrl\n  }\n}\n\nexport default class Mediaplayer extends Lightning.Component {\n  _construct() {\n    this._skipRenderToTexture = false\n    this._metrics = null\n    this._textureMode = Settings.get('platform', 'textureMode') || false\n    Log.info('Texture mode: ' + this._textureMode)\n    console.warn(\n      [\n        \"The 'MediaPlayer'-plugin in the Lightning-SDK is deprecated and will be removed in future releases.\",\n        \"Please consider using the new 'VideoPlayer'-plugin instead.\",\n        'https://rdkcentral.github.io/Lightning-SDK/#/plugins/videoplayer',\n      ].join('\\n\\n')\n    )\n  }\n\n  static _template() {\n    return {\n      Video: {\n        VideoWrap: {\n          VideoTexture: {\n            visible: false,\n            pivot: 0.5,\n            texture: { type: Lightning.textures.StaticTexture, options: {} },\n          },\n        },\n      },\n    }\n  }\n\n  set skipRenderToTexture(v) {\n    this._skipRenderToTexture = v\n  }\n\n  get textureMode() {\n    return this._textureMode\n  }\n\n  get videoView() {\n    return this.tag('Video')\n  }\n\n  _init() {\n    //re-use videotag if already there\n    const videoEls = document.getElementsByTagName('video')\n    if (videoEls && videoEls.length > 0) this.videoEl = videoEls[0]\n    else {\n      this.videoEl = document.createElement('video')\n      this.videoEl.setAttribute('id', 'video-player')\n      this.videoEl.style.position = 'absolute'\n      this.videoEl.style.zIndex = '1'\n      this.videoEl.style.display = 'none'\n      this.videoEl.setAttribute('width', '100%')\n      this.videoEl.setAttribute('height', '100%')\n\n      this.videoEl.style.visibility = this.textureMode ? 'hidden' : 'visible'\n      document.body.appendChild(this.videoEl)\n    }\n    if (this.textureMode && !this._skipRenderToTexture) {\n      this._createVideoTexture()\n    }\n\n    this.eventHandlers = []\n  }\n\n  _registerListeners() {\n    events.forEach(event => {\n      const handler = e => {\n        if (this._metrics && this._metrics[event] && typeof this._metrics[event] === 'function') {\n          this._metrics[event]({ currentTime: this.videoEl.currentTime })\n        }\n        this.fire(event, { videoElement: this.videoEl, event: e })\n      }\n      this.eventHandlers.push(handler)\n      this.videoEl.addEventListener(event, handler)\n    })\n  }\n\n  _deregisterListeners() {\n    Log.info('Deregistering event listeners MediaPlayer')\n    events.forEach((event, index) => {\n      this.videoEl.removeEventListener(event, this.eventHandlers[index])\n    })\n    this.eventHandlers = []\n  }\n\n  _attach() {\n    this._registerListeners()\n  }\n\n  _detach() {\n    this._deregisterListeners()\n    this.close()\n  }\n\n  _createVideoTexture() {\n    const stage = this.stage\n\n    const gl = stage.gl\n    const glTexture = gl.createTexture()\n    gl.bindTexture(gl.TEXTURE_2D, glTexture)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n\n    this.videoTexture.options = { source: glTexture, w: this.videoEl.width, h: this.videoEl.height }\n  }\n\n  _startUpdatingVideoTexture() {\n    if (this.textureMode && !this._skipRenderToTexture) {\n      const stage = this.stage\n      if (!this._updateVideoTexture) {\n        this._updateVideoTexture = () => {\n          if (this.videoTexture.options.source && this.videoEl.videoWidth && this.active) {\n            const gl = stage.gl\n\n            const currentTime = new Date().getTime()\n\n            // When BR2_PACKAGE_GST1_PLUGINS_BAD_PLUGIN_DEBUGUTILS is not set in WPE, webkitDecodedFrameCount will not be available.\n            // We'll fallback to fixed 30fps in this case.\n            const frameCount = this.videoEl.webkitDecodedFrameCount\n\n            const mustUpdate = frameCount\n              ? this._lastFrame !== frameCount\n              : this._lastTime < currentTime - 30\n\n            if (mustUpdate) {\n              this._lastTime = currentTime\n              this._lastFrame = frameCount\n              try {\n                gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source)\n                gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false)\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.videoEl)\n                this._lastFrame = this.videoEl.webkitDecodedFrameCount\n                this.videoTextureView.visible = true\n\n                this.videoTexture.options.w = this.videoEl.videoWidth\n                this.videoTexture.options.h = this.videoEl.videoHeight\n                const expectedAspectRatio = this.videoTextureView.w / this.videoTextureView.h\n                const realAspectRatio = this.videoEl.videoWidth / this.videoEl.videoHeight\n                if (expectedAspectRatio > realAspectRatio) {\n                  this.videoTextureView.scaleX = realAspectRatio / expectedAspectRatio\n                  this.videoTextureView.scaleY = 1\n                } else {\n                  this.videoTextureView.scaleY = expectedAspectRatio / realAspectRatio\n                  this.videoTextureView.scaleX = 1\n                }\n              } catch (e) {\n                Log.error('texImage2d video', e)\n                this._stopUpdatingVideoTexture()\n                this.videoTextureView.visible = false\n              }\n              this.videoTexture.source.forceRenderUpdate()\n            }\n          }\n        }\n      }\n      if (!this._updatingVideoTexture) {\n        stage.on('frameStart', this._updateVideoTexture)\n        this._updatingVideoTexture = true\n      }\n    }\n  }\n\n  _stopUpdatingVideoTexture() {\n    if (this.textureMode) {\n      const stage = this.stage\n      stage.removeListener('frameStart', this._updateVideoTexture)\n      this._updatingVideoTexture = false\n      this.videoTextureView.visible = false\n\n      if (this.videoTexture.options.source) {\n        const gl = stage.gl\n        gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source)\n        gl.clearColor(0, 0, 0, 1)\n        gl.clear(gl.COLOR_BUFFER_BIT)\n      }\n    }\n  }\n\n  updateSettings(settings = {}) {\n    // The Component that 'consumes' the media player.\n    this._consumer = settings.consumer\n\n    if (this._consumer && this._consumer.getMediaplayerSettings) {\n      // Allow consumer to add settings.\n      settings = Object.assign(settings, this._consumer.getMediaplayerSettings())\n    }\n\n    if (!Lightning.Utils.equalValues(this._stream, settings.stream)) {\n      if (settings.stream && settings.stream.keySystem) {\n        navigator\n          .requestMediaKeySystemAccess(\n            settings.stream.keySystem.id,\n            settings.stream.keySystem.config\n          )\n          .then(keySystemAccess => {\n            return keySystemAccess.createMediaKeys()\n          })\n          .then(createdMediaKeys => {\n            return this.videoEl.setMediaKeys(createdMediaKeys)\n          })\n          .then(() => {\n            if (settings.stream && settings.stream.src) this.open(settings.stream.src)\n          })\n          .catch(() => {\n            console.error('Failed to set up MediaKeys')\n          })\n      } else if (settings.stream && settings.stream.src) {\n        // This is here to be backwards compatible, will be removed\n        // in future sdk release\n        if (Settings.get('app', 'hls')) {\n          if (!window.Hls) {\n            window.Hls = class Hls {\n              static isSupported() {\n                console.warn('hls-light not included')\n                return false\n              }\n            }\n          }\n          if (window.Hls.isSupported()) {\n            if (!this._hls) this._hls = new window.Hls({ liveDurationInfinity: true })\n            this._hls.loadSource(settings.stream.src)\n            this._hls.attachMedia(this.videoEl)\n            this.videoEl.style.display = 'block'\n          }\n        } else {\n          this.open(settings.stream.src)\n        }\n      } else {\n        this.close()\n      }\n      this._stream = settings.stream\n    }\n\n    this._setHide(settings.hide)\n    this._setVideoArea(settings.videoPos)\n  }\n\n  _setHide(hide) {\n    if (this.textureMode) {\n      this.tag('Video').setSmooth('alpha', hide ? 0 : 1)\n    } else {\n      this.videoEl.style.visibility = hide ? 'hidden' : 'visible'\n    }\n  }\n\n  open(url, settings = { hide: false, videoPosition: null }) {\n    // prep the media url to play depending on platform (mediaPlayerplugin)\n    url = mediaUrl(url)\n    this._metrics = Metrics.media(url)\n    Log.info('Playing stream', url)\n    if (this.application.noVideo) {\n      Log.info('noVideo option set, so ignoring: ' + url)\n      return\n    }\n    // close the video when opening same url as current (effectively reloading)\n    if (this.videoEl.getAttribute('src') === url) {\n      this.close()\n    }\n    this.videoEl.setAttribute('src', url)\n\n    // force hide, then force show (in next tick!)\n    // (fixes comcast playback rollover issue)\n    this.videoEl.style.visibility = 'hidden'\n    this.videoEl.style.display = 'none'\n\n    setTimeout(() => {\n      this.videoEl.style.display = 'block'\n      this.videoEl.style.visibility = 'visible'\n    })\n\n    this._setHide(settings.hide)\n    this._setVideoArea(settings.videoPosition || [0, 0, 1920, 1080])\n  }\n\n  close() {\n    // We need to pause first in order to stop sound.\n    this.videoEl.pause()\n    this.videoEl.removeAttribute('src')\n\n    // force load to reset everything without errors\n    this.videoEl.load()\n\n    this._clearSrc()\n\n    this.videoEl.style.display = 'none'\n  }\n\n  playPause() {\n    if (this.isPlaying()) {\n      this.doPause()\n    } else {\n      this.doPlay()\n    }\n  }\n\n  get muted() {\n    return this.videoEl.muted\n  }\n\n  set muted(v) {\n    this.videoEl.muted = v\n  }\n\n  get loop() {\n    return this.videoEl.loop\n  }\n\n  set loop(v) {\n    this.videoEl.loop = v\n  }\n\n  isPlaying() {\n    return this._getState() === 'Playing'\n  }\n\n  doPlay() {\n    this.videoEl.play()\n  }\n\n  doPause() {\n    this.videoEl.pause()\n  }\n\n  reload() {\n    var url = this.videoEl.getAttribute('src')\n    this.close()\n    this.videoEl.src = url\n  }\n\n  getPosition() {\n    return Promise.resolve(this.videoEl.currentTime)\n  }\n\n  setPosition(pos) {\n    this.videoEl.currentTime = pos\n  }\n\n  getDuration() {\n    return Promise.resolve(this.videoEl.duration)\n  }\n\n  seek(time, absolute = false) {\n    if (absolute) {\n      this.videoEl.currentTime = time\n    } else {\n      this.videoEl.currentTime += time\n    }\n  }\n\n  get videoTextureView() {\n    return this.tag('Video').tag('VideoTexture')\n  }\n\n  get videoTexture() {\n    return this.videoTextureView.texture\n  }\n\n  _setVideoArea(videoPos) {\n    if (Lightning.Utils.equalValues(this._videoPos, videoPos)) {\n      return\n    }\n\n    this._videoPos = videoPos\n\n    if (this.textureMode) {\n      this.videoTextureView.patch({\n        smooth: {\n          x: videoPos[0],\n          y: videoPos[1],\n          w: videoPos[2] - videoPos[0],\n          h: videoPos[3] - videoPos[1],\n        },\n      })\n    } else {\n      const precision = this.stage.getRenderPrecision()\n      this.videoEl.style.left = Math.round(videoPos[0] * precision) + 'px'\n      this.videoEl.style.top = Math.round(videoPos[1] * precision) + 'px'\n      this.videoEl.style.width = Math.round((videoPos[2] - videoPos[0]) * precision) + 'px'\n      this.videoEl.style.height = Math.round((videoPos[3] - videoPos[1]) * precision) + 'px'\n    }\n  }\n\n  _fireConsumer(event, args) {\n    if (this._consumer) {\n      this._consumer.fire(event, args)\n    }\n  }\n\n  _equalInitData(buf1, buf2) {\n    if (!buf1 || !buf2) return false\n    if (buf1.byteLength != buf2.byteLength) return false\n    const dv1 = new Int8Array(buf1)\n    const dv2 = new Int8Array(buf2)\n    for (let i = 0; i != buf1.byteLength; i++) if (dv1[i] != dv2[i]) return false\n    return true\n  }\n\n  error(args) {\n    this._fireConsumer('$mediaplayerError', args)\n    this._setState('')\n    return ''\n  }\n\n  loadeddata(args) {\n    this._fireConsumer('$mediaplayerLoadedData', args)\n  }\n\n  play(args) {\n    this._fireConsumer('$mediaplayerPlay', args)\n  }\n\n  playing(args) {\n    this._fireConsumer('$mediaplayerPlaying', args)\n    this._setState('Playing')\n  }\n\n  canplay(args) {\n    this.videoEl.play()\n    this._fireConsumer('$mediaplayerStart', args)\n  }\n\n  loadstart(args) {\n    this._fireConsumer('$mediaplayerLoad', args)\n  }\n\n  seeked() {\n    this._fireConsumer('$mediaplayerSeeked', {\n      currentTime: this.videoEl.currentTime,\n      duration: this.videoEl.duration || 1,\n    })\n  }\n\n  seeking() {\n    this._fireConsumer('$mediaplayerSeeking', {\n      currentTime: this.videoEl.currentTime,\n      duration: this.videoEl.duration || 1,\n    })\n  }\n\n  durationchange(args) {\n    this._fireConsumer('$mediaplayerDurationChange', args)\n  }\n\n  encrypted(args) {\n    const video = args.videoElement\n    const event = args.event\n    // FIXME: Double encrypted events need to be properly filtered by Gstreamer\n    if (video.mediaKeys && !this._equalInitData(this._previousInitData, event.initData)) {\n      this._previousInitData = event.initData\n      this._fireConsumer('$mediaplayerEncrypted', args)\n    }\n  }\n\n  static _states() {\n    return [\n      class Playing extends this {\n        $enter() {\n          this._startUpdatingVideoTexture()\n        }\n        $exit() {\n          this._stopUpdatingVideoTexture()\n        }\n        timeupdate() {\n          this._fireConsumer('$mediaplayerProgress', {\n            currentTime: this.videoEl.currentTime,\n            duration: this.videoEl.duration || 1,\n          })\n        }\n        ended(args) {\n          this._fireConsumer('$mediaplayerEnded', args)\n          this._setState('')\n        }\n        pause(args) {\n          this._fireConsumer('$mediaplayerPause', args)\n          this._setState('Playing.Paused')\n        }\n        _clearSrc() {\n          this._fireConsumer('$mediaplayerStop', {})\n          this._setState('')\n        }\n        static _states() {\n          return [class Paused extends this {}]\n        }\n      },\n    ]\n  }\n}\n","class localCookie{constructor(e){return e=e||{},this.forceCookies=e.forceCookies||!1,!0===this._checkIfLocalStorageWorks()&&!0!==e.forceCookies?{getItem:this._getItemLocalStorage,setItem:this._setItemLocalStorage,removeItem:this._removeItemLocalStorage,clear:this._clearLocalStorage}:{getItem:this._getItemCookie,setItem:this._setItemCookie,removeItem:this._removeItemCookie,clear:this._clearCookies}}_checkIfLocalStorageWorks(){if(\"undefined\"==typeof localStorage)return!1;try{return localStorage.setItem(\"feature_test\",\"yes\"),\"yes\"===localStorage.getItem(\"feature_test\")&&(localStorage.removeItem(\"feature_test\"),!0)}catch(e){return!1}}_getItemLocalStorage(e){return window.localStorage.getItem(e)}_setItemLocalStorage(e,t){return window.localStorage.setItem(e,t)}_removeItemLocalStorage(e){return window.localStorage.removeItem(e)}_clearLocalStorage(){return window.localStorage.clear()}_getItemCookie(e){var t=document.cookie.match(RegExp(\"(?:^|;\\\\s*)\"+function(e){return e.replace(/([.*+?\\^${}()|\\[\\]\\/\\\\])/g,\"\\\\$1\")}(e)+\"=([^;]*)\"));return t&&\"\"===t[1]&&(t[1]=null),t?t[1]:null}_setItemCookie(e,t){var o=new Date,r=new Date(o.getTime()+15768e7);document.cookie=`${e}=${t}; expires=${r.toUTCString()};`}_removeItemCookie(e){document.cookie=`${e}=;Max-Age=-99999999;`}_clearCookies(){document.cookie.split(\";\").forEach(e=>{document.cookie=e.replace(/^ +/,\"\").replace(/=.*/,\"=;expires=Max-Age=-99999999\")})}}export default localCookie;\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings'\nimport localCookie from 'localCookie/module/localCookie.js'\n\nlet namespace\nlet lc\n\nexport const initStorage = () => {\n  namespace = Settings.get('platform', 'id')\n  // todo: pass options (for example to force the use of cookies)\n  lc = new localCookie()\n}\n\nconst namespacedKey = key => (namespace ? [namespace, key].join('.') : key)\n\nexport default {\n  get(key) {\n    try {\n      return JSON.parse(lc.getItem(namespacedKey(key)))\n    } catch (e) {\n      return null\n    }\n  },\n  set(key, value) {\n    try {\n      lc.setItem(namespacedKey(key), JSON.stringify(value))\n      return true\n    } catch (e) {\n      return false\n    }\n  },\n  remove(key) {\n    lc.removeItem(namespacedKey(key))\n  },\n  clear() {\n    if (namespace) {\n      lc.keys().forEach(key => {\n        // remove the item if in the namespace\n        key.indexOf(namespace + '.') === 0 ? lc.removeItem(key) : null\n      })\n    } else {\n      lc.clear()\n    }\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const hasRegex = /\\{\\/(.*?)\\/([igm]{0,3})\\}/g\nexport const isWildcard = /^[!*$]$/\nexport const hasLookupId = /\\/:\\w+?@@([0-9]+?)@@/\nexport const isNamedGroup = /^\\/:/\n\n/**\n * Test if a route is part regular expressed\n * and replace it for a simple character\n * @param route\n * @returns {*}\n */\nexport const stripRegex = (route, char = 'R') => {\n  // if route is part regular expressed we replace\n  // the regular expression for a character to\n  // simplify floor calculation and backtracking\n  if (hasRegex.test(route)) {\n    route = route.replace(hasRegex, char)\n  }\n  return route\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Create a local request register\n * @param flags\n * @returns {Map<any, any>}\n */\nexport const createRegister = flags => {\n  const reg = new Map()\n  // store user defined and router\n  // defined flags in register\n  ;[...Object.keys(flags), ...Object.getOwnPropertySymbols(flags)].forEach(key => {\n    reg.set(key, flags[key])\n  })\n  return reg\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isBoolean, isObject, symbols } from '../utils/helpers'\nimport { createRegister } from '../utils/register'\nimport Log from '../../Log'\n\nexport default class Request {\n  constructor(hash = '', navArgs, storeCaller) {\n    /**\n     * Hash we navigate to\n     * @type {string}\n     * @private\n     */\n    this._hash = hash\n\n    /**\n     * Do we store previous hash in history\n     * @type {boolean}\n     * @private\n     */\n    this._storeCaller = storeCaller\n\n    /**\n     * Request and navigate data\n     * @type {Map}\n     * @private\n     */\n    this._register = new Map()\n\n    /**\n     * Flag if the instance is created due to\n     * this request\n     * @type {boolean}\n     * @private\n     */\n    this._isCreated = false\n\n    /**\n     * Flag if the instance is shared between\n     * previous and current request\n     * @type {boolean}\n     * @private\n     */\n    this._isSharedInstance = false\n\n    /**\n     * Flag if the request has been cancelled\n     * @type {boolean}\n     * @private\n     */\n    this._cancelled = false\n\n    /**\n     * if instance is shared between requests we copy state object\n     * from instance before the new request overrides state\n     * @type {null}\n     * @private\n     */\n    this._copiedHistoryState = null\n\n    // if there are arguments attached to navigate()\n    // we store them in new request\n    if (isObject(navArgs)) {\n      this._register = createRegister(navArgs)\n    } else if (isBoolean(navArgs)) {\n      // if second navigate() argument is explicitly\n      // set to false we prevent the calling page\n      // from ending up in history\n      this._storeCaller = navArgs\n    }\n    // @todo: remove because we can simply check\n    // ._storeCaller property\n    this._register.set(symbols.store, this._storeCaller)\n  }\n\n  cancel() {\n    Log.debug('[router]:', `cancelled ${this._hash}`)\n    this._cancelled = true\n  }\n\n  get url() {\n    return this._hash\n  }\n\n  get register() {\n    return this._register\n  }\n\n  get hash() {\n    return this._hash\n  }\n\n  set hash(args) {\n    this._hash = args\n  }\n\n  get route() {\n    return this._route\n  }\n\n  set route(args) {\n    this._route = args\n  }\n\n  get provider() {\n    return this._provider\n  }\n\n  set provider(args) {\n    this._provider = args\n  }\n\n  get providerType() {\n    return this._providerType\n  }\n\n  set providerType(args) {\n    this._providerType = args\n  }\n\n  set page(args) {\n    this._page = args\n  }\n\n  get page() {\n    return this._page\n  }\n\n  set isCreated(args) {\n    this._isCreated = args\n  }\n\n  get isCreated() {\n    return this._isCreated\n  }\n\n  get isSharedInstance() {\n    return this._isSharedInstance\n  }\n\n  set isSharedInstance(args) {\n    this._isSharedInstance = args\n  }\n\n  get isCancelled() {\n    return this._cancelled\n  }\n\n  set copiedHistoryState(v) {\n    this._copiedHistoryState = v\n  }\n\n  get copiedHistoryState() {\n    return this._copiedHistoryState\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFunction } from '../utils/helpers'\n\nexport default class Route {\n  constructor(config = {}) {\n    // keep backwards compatible\n    let type = ['on', 'before', 'after'].reduce((acc, type) => {\n      return isFunction(config[type]) ? type : acc\n    }, undefined)\n\n    this._cfg = config\n    if (type) {\n      this._provider = {\n        type,\n        request: config[type],\n      }\n    }\n  }\n\n  get path() {\n    return this._cfg.path\n  }\n\n  get component() {\n    return this._cfg.component\n  }\n\n  get options() {\n    return this._cfg.options\n  }\n\n  get widgets() {\n    return this._cfg.widgets\n  }\n\n  get cache() {\n    return this._cfg.cache\n  }\n\n  get hook() {\n    return this._cfg.hook\n  }\n\n  get beforeNavigate() {\n    return this._cfg.beforeNavigate\n  }\n\n  get provider() {\n    return this._provider\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { hasRegex, hasLookupId, isNamedGroup, stripRegex } from './regex'\nimport { routes, routeExists, bootRequest, getRoutes } from './router'\nimport Request from '../model/Request'\nimport Route from '../model/Route'\nimport { objectToQueryString, isObject, isString } from './helpers'\n\n/**\n * Simple route length calculation\n * @param route {string}\n * @returns {number} - floor\n */\nexport const getFloor = route => {\n  return stripRegex(route).split('/').length\n}\n\n/**\n * return all stored routes that live on the same floor\n * @param floor\n * @returns {Array}\n */\nconst getRoutesByFloor = floor => {\n  const matches = []\n  // simple filter of level candidates\n  for (let [route] of routes.entries()) {\n    if (getFloor(route) === floor) {\n      matches.push(route)\n    }\n  }\n  return matches\n}\n\n/**\n * return a matching route by provided hash\n * hash: home/browse/12 will match:\n * route: home/browse/:categoryId\n * @param hash {string}\n * @returns {boolean|{}} - route\n */\nexport const getRouteByHash = hash => {\n  // @todo: clean up on handleHash\n  hash = hash.replace(/^#/, '')\n\n  const getUrlParts = /(\\/?:?[@!*\\w%\\s:-]+)/g\n  // grab possible candidates from stored routes\n  const candidates = getRoutesByFloor(getFloor(hash))\n  // break hash down in chunks\n  const hashParts = hash.match(getUrlParts) || []\n\n  // to simplify the route matching and prevent look around\n  // in our getUrlParts regex we get the regex part from\n  // route candidate and store them so that we can reference\n  // them when we perform the actual regex against hash\n  let regexStore = []\n\n  let matches = candidates.filter(route => {\n    let isMatching = true\n    // replace regex in route with lookup id => @@{storeId}@@\n    if (hasRegex.test(route)) {\n      const regMatches = route.match(hasRegex)\n      if (regMatches && regMatches.length) {\n        route = regMatches.reduce((fullRoute, regex) => {\n          const lookupId = regexStore.length\n          fullRoute = fullRoute.replace(regex, `@@${lookupId}@@`)\n          regexStore.push(regex.substring(1, regex.length - 1))\n          return fullRoute\n        }, route)\n      }\n    }\n\n    const routeParts = route.match(getUrlParts) || []\n\n    for (let i = 0, j = routeParts.length; i < j; i++) {\n      const routePart = routeParts[i]\n      const hashPart = hashParts[i]\n\n      // Since we support catch-all and regex driven name groups\n      // we first test for regex lookup id and see if the regex\n      // matches the value from the hash\n      if (hasLookupId.test(routePart)) {\n        const routeMatches = hasLookupId.exec(routePart)\n        const storeId = routeMatches[1]\n        const routeRegex = regexStore[storeId]\n\n        // split regex and modifiers so we can use both\n        // to create a new RegExp\n        // eslint-disable-next-line\n                const regMatches = /\\/([^\\/]+)\\/([igm]{0,3})/.exec(routeRegex)\n\n        if (regMatches && regMatches.length) {\n          const expression = regMatches[1]\n          const modifiers = regMatches[2]\n\n          const regex = new RegExp(`^/${expression}$`, modifiers)\n\n          if (!regex.test(hashPart)) {\n            isMatching = false\n          }\n        }\n      } else if (isNamedGroup.test(routePart)) {\n        // we kindly skip namedGroups because this is dynamic\n        // we only need to the static and regex drive parts\n        continue\n      } else if (hashPart && routePart.toLowerCase() !== hashPart.toLowerCase()) {\n        isMatching = false\n      }\n    }\n    return isMatching\n  })\n\n  if (matches.length) {\n    if (matches.indexOf(hash) !== -1) {\n      const match = matches[matches.indexOf(hash)]\n      return routes.get(match)\n    } else {\n      // we give prio to static routes over dynamic\n      matches = matches.sort(a => {\n        return isNamedGroup.test(a) ? -1 : 1\n      })\n      // would be strange if this fails\n      // but still we test\n      if (routeExists(matches[0])) {\n        return routes.get(matches[0])\n      }\n    }\n  }\n  return false\n}\n\nexport const getValuesFromHash = (hash = '', path) => {\n  // replace the regex definition from the route because\n  // we already did the matching part\n  path = stripRegex(path, '')\n\n  const getUrlParts = /(\\/?:?[\\w%\\s:.-]+)/g\n  const hashParts = hash.match(getUrlParts) || []\n  const routeParts = path.match(getUrlParts) || []\n  const getNamedGroup = /^\\/:([\\w-]+)\\/?/\n\n  return routeParts.reduce((storage, value, index) => {\n    const match = getNamedGroup.exec(value)\n    if (match && match.length) {\n      storage.set(match[1], decodeURIComponent(hashParts[index].replace(/^\\//, '')))\n    }\n    return storage\n  }, new Map())\n}\n\nexport const getOption = (stack, prop) => {\n  // eslint-disable-next-line\n    if(stack && stack.hasOwnProperty(prop)){\n    return stack[prop]\n  }\n  // we explicitly return undefined since we're testing\n  // for explicit test values\n}\n\n/**\n * create and return new Route instance\n * @param config\n */\nexport const createRoute = config => {\n  // we need to provide a bit of additional logic\n  // for the bootComponent\n  if (config.path === '$') {\n    let options = {\n      preventStorage: true,\n    }\n    if (isObject(config.options)) {\n      options = {\n        ...config.options,\n        ...options,\n      }\n    }\n    config.options = options\n    // if configured add reference to bootRequest\n    // as router after provider\n    if (bootRequest) {\n      config.after = bootRequest\n    }\n  }\n  return new Route(config)\n}\n\n/**\n * Create a new Router request object\n * @param url\n * @param args\n * @param store\n * @returns {*}\n */\nexport const createRequest = (url, args, store) => {\n  return new Request(url, args, store)\n}\n\nexport const getHashByName = obj => {\n  if (!obj.to && !obj.name) {\n    return false\n  }\n  const route = getRouteByName(obj.to || obj.name)\n  const hasDynamicGroup = /\\/:([\\w-]+)\\/?/\n  let hash = route\n\n  // if route contains dynamic group\n  // we replace them with the provided params\n  if (hasDynamicGroup.test(route)) {\n    if (obj.params) {\n      const keys = Object.keys(obj.params)\n      hash = keys.reduce((acc, key) => {\n        return acc.replace(`:${key}`, obj.params[key])\n      }, route)\n    }\n    if (obj.query) {\n      return `${hash}${objectToQueryString(obj.query)}`\n    }\n  }\n  return hash\n}\n\nconst getRouteByName = name => {\n  for (let [path, route] of routes.entries()) {\n    if (route.name === name) {\n      return path\n    }\n  }\n  return false\n}\n\nexport const keepActivePageAlive = (route, request) => {\n  if (isString(route)) {\n    const routes = getRoutes()\n    if (routes.has(route)) {\n      route = routes.get(route)\n    } else {\n      return false\n    }\n  }\n\n  const register = request.register\n  const routeOptions = route.options\n\n  if (register.has('keepAlive')) {\n    return register.get('keepAlive')\n  } else if (routeOptions && routeOptions.keepAlive) {\n    return routeOptions.keepAlive\n  }\n\n  return false\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isArray, isFunction, ucfirst } from './helpers'\n\nexport default (page, events = [], params = {}) => {\n  if (!isArray(events)) {\n    events = [events]\n  }\n  events.forEach(e => {\n    const event = `_on${ucfirst(e)}`\n    if (isFunction(page[event])) {\n      page[event](params)\n    }\n  })\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { app, widgetsHost } from './router'\nimport { ucfirst } from './helpers'\nimport emit from './emit'\n\nlet activeWidget = null\n\nexport const getReferences = () => {\n  if (!widgetsHost) {\n    return\n  }\n  return widgetsHost.get().reduce((storage, widget) => {\n    const key = widget.ref.toLowerCase()\n    storage[key] = widget\n    return storage\n  }, {})\n}\n\n/**\n * update the visibility of the available widgets\n * for the current page / route\n * @param page\n */\nexport const updateWidgets = (widgets, page) => {\n  // force lowercase lookup\n  const configured = (widgets || []).map(ref => ref.toLowerCase())\n\n  widgetsHost.forEach(widget => {\n    widget.visible = configured.indexOf(widget.ref.toLowerCase()) !== -1\n    if (widget.visible) {\n      emit(widget, ['activated'], page)\n    }\n  })\n  if (app.state === 'Widgets' && activeWidget && !activeWidget.visible) {\n    app._setState('')\n  }\n}\n\nconst getWidgetByName = name => {\n  name = ucfirst(name)\n  return widgetsHost.getByRef(name) || false\n}\n\n/**\n * delegate app focus to a on-screen widget\n * @param name - {string}\n */\nexport const focusWidget = name => {\n  const widget = getWidgetByName(name)\n  if (widget) {\n    setActiveWidget(widget)\n\n    // if app is already in 'Widgets' state we can assume that\n    // focus has been delegated from one widget to another so\n    // we need to set the new widget reference and trigger a\n    // new focus calculation of Lightning's focuspath\n    if (app.state === 'Widgets') {\n      app.reload(activeWidget)\n    } else {\n      app._setState('Widgets', [activeWidget])\n    }\n  }\n}\n\nexport const handleRemote = (type, name) => {\n  if (type === 'widget') {\n    focusWidget(name)\n  } else if (type === 'page') {\n    restoreFocus()\n  }\n}\n\nexport const restoreFocus = () => {\n  activeWidget = null\n  app._setState('')\n}\n\nexport const getActiveWidget = () => {\n  return activeWidget\n}\n\nexport const setActiveWidget = instance => {\n  activeWidget = instance\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getReferences } from './widgets'\n\nexport const createComponent = (stage, type) => {\n  return stage.c({\n    type,\n    visible: false,\n    widgets: getReferences(),\n  })\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getActiveHash, getActivePage } from './router'\nimport { getOption, getRouteByHash } from './route'\nimport { isFunction, isObject, isArray, isBoolean, symbols } from './helpers'\nimport { getRouterConfig } from './router'\n\n/**\n * Simple flat array that holds the visited hashes + state Object\n * so the router can navigate back to them\n * @type {Array}\n */\nlet history = []\n\nexport const updateHistory = request => {\n  const hash = getActiveHash()\n  if (!hash) {\n    return\n  }\n\n  // navigate storage flag\n  const register = request.register\n  const forceNavigateStore = register.get(symbols.store)\n\n  // test preventStorage on route configuration\n  const activeRoute = getRouteByHash(hash)\n  const preventStorage = getOption(activeRoute.options, 'preventStorage')\n\n  // we give prio to navigate storage flag\n  let store = isBoolean(forceNavigateStore) ? forceNavigateStore : !preventStorage\n\n  if (store) {\n    const toStore = hash.replace(/^\\//, '')\n    const location = locationInHistory(toStore)\n    const stateObject = getStateObject(getActivePage(), request)\n    const routerConfig = getRouterConfig()\n\n    // store hash if it's not a part of history or flag for\n    // storage of same hash is true\n    if (location === -1 || routerConfig.get('storeSameHash')) {\n      history.push({ hash: toStore, state: stateObject })\n    } else {\n      // if we visit the same route we want to sync history\n      const prev = history.splice(location, 1)[0]\n      history.push({ hash: prev.hash, state: stateObject })\n    }\n  }\n}\n\nconst locationInHistory = hash => {\n  for (let i = 0; i < history.length; i++) {\n    if (history[i].hash === hash) {\n      return i\n    }\n  }\n  return -1\n}\n\nexport const getHistoryState = hash => {\n  let state = null\n  if (history.length) {\n    // if no hash is provided we get the last\n    // pushed history record\n    if (!hash) {\n      const record = history[history.length - 1]\n      // could be null\n      state = record.state\n    } else {\n      if (locationInHistory(hash) !== -1) {\n        const record = history[locationInHistory(hash)]\n        state = record.state\n      }\n    }\n  }\n  return state\n}\n\nexport const replaceHistoryState = (state = null, hash) => {\n  if (!history.length) {\n    return\n  }\n  const location = hash ? locationInHistory(hash) : history.length - 1\n  if (location !== -1 && isObject(state)) {\n    history[location].state = state\n  }\n}\n\nconst getStateObject = (page, request) => {\n  // if the new request shared instance with the\n  // previous request we used the copied state object\n  if (request.isSharedInstance) {\n    if (request.copiedHistoryState) {\n      return request.copiedHistoryState\n    }\n  } else if (page && isFunction(page.historyState)) {\n    return page.historyState()\n  }\n  return null\n}\n\nexport const getHistory = () => {\n  return history.slice(0)\n}\n\nexport const setHistory = (arr = []) => {\n  if (isArray(arr)) {\n    history = arr\n  }\n}\n","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Simple module for localization of strings.\n *\n * How to use:\n * 1. Create localization file with following JSON format:\n * {\n *   \"en\" :{\n *     \"how\": \"How do you want your egg today?\",\n *     \"boiledEgg\": \"Boiled egg\",\n *     \"softBoiledEgg\": \"Soft-boiled egg\",\n *     \"choice\": \"How to choose the egg\",\n *     \"buyQuestion\": \"I'd like to buy {0} eggs, {1} dollars each.\"\n *   },\n *\n *   \"it\": {\n *     \"how\": \"Come vuoi il tuo uovo oggi?\",\n *     \"boiledEgg\": \"Uovo sodo\",\n *     \"softBoiledEgg\": \"Uovo alla coque\",\n *     \"choice\": \"Come scegliere l'uovo\",\n *     \"buyQuestion\": \"Mi piacerebbe comprare {0} uova, {1} dollari ciascuna.\"\n *   }\n * }\n *\n * 2. Use Locale's module load method, specifying path to your localization file and set chosen language, e.g.:\n *    > Locale.load('static/locale/locale.json');\n *    > Locale.setLanguage('en');\n *\n * 3. Use localization strings:\n *    > console.log(Locale.tr.how);\n *    How do you want your egg today?\n *    > console.log(Locale.tr.boiledEgg);\n *    Boiled egg\n *\n * 4. String formatting\n *    > console.log(Locale.tr.buyQuestion.format(10, 0.5));\n *    I'd like to buy 10 eggs, 0.5 dollars each.\n */\n\nimport Log from '../Log'\n\nlet warned = false\nconst deprecated = (force = false) => {\n  if (force === true || warned === false) {\n    console.warn(\n      [\n        \"The 'Locale'-plugin in the Lightning-SDK is deprecated and will be removed in future releases.\",\n        \"Please consider using the new 'Language'-plugin instead.\",\n        'https://rdkcentral.github.io/Lightning-SDK/#/plugins/language',\n      ].join('\\n\\n')\n    )\n  }\n  warned = true\n}\nclass Locale {\n  constructor() {\n    this.__enabled = false\n  }\n\n  /**\n   * Loads translation object from external json file.\n   *\n   * @param {String} path Path to resource.\n   * @return {Promise}\n   */\n  async load(path) {\n    if (!this.__enabled) {\n      return\n    }\n\n    await fetch(path)\n      .then(resp => resp.json())\n      .then(resp => {\n        this.loadFromObject(resp)\n      })\n  }\n\n  /**\n   * Sets language used by module.\n   *\n   * @param {String} lang\n   */\n  setLanguage(lang) {\n    deprecated()\n    this.__enabled = true\n    this.language = lang\n  }\n\n  /**\n   * Returns reference to translation object for current language.\n   *\n   * @return {Object}\n   */\n  get tr() {\n    deprecated(true)\n    return this.__trObj[this.language]\n  }\n\n  /**\n   * Loads translation object from existing object (binds existing object).\n   *\n   * @param {Object} trObj\n   */\n  loadFromObject(trObj) {\n    deprecated()\n    const fallbackLanguage = 'en'\n    if (Object.keys(trObj).indexOf(this.language) === -1) {\n      Log.warn('No translations found for: ' + this.language)\n      if (Object.keys(trObj).indexOf(fallbackLanguage) > -1) {\n        Log.warn('Using fallback language: ' + fallbackLanguage)\n        this.language = fallbackLanguage\n      } else {\n        const error = 'No translations found for fallback language: ' + fallbackLanguage\n        Log.error(error)\n        throw Error(error)\n      }\n    }\n\n    this.__trObj = trObj\n    for (const lang of Object.values(this.__trObj)) {\n      for (const str of Object.keys(lang)) {\n        lang[str] = new LocalizedString(lang[str])\n      }\n    }\n  }\n}\n\n/**\n * Extended string class used for localization.\n */\nclass LocalizedString extends String {\n  /**\n   * Returns formatted LocalizedString.\n   * Replaces each placeholder value (e.g. {0}, {1}) with corresponding argument.\n   *\n   * E.g.:\n   * > new LocalizedString('{0} and {1} and {0}').format('A', 'B');\n   * A and B and A\n   *\n   * @param  {...any} args List of arguments for placeholders.\n   */\n  format(...args) {\n    const sub = args.reduce((string, arg, index) => string.split(`{${index}}`).join(arg), this)\n    return new LocalizedString(sub)\n  }\n}\n\nexport default new Locale()\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../Lightning'\n\nexport default class VersionLabel extends Lightning.Component {\n  static _template() {\n    return {\n      rect: true,\n      color: 0xbb0078ac,\n      h: 40,\n      w: 100,\n      x: w => w - 50,\n      y: h => h - 50,\n      mount: 1,\n      Text: {\n        w: w => w,\n        h: h => h,\n        y: 5,\n        x: 20,\n        text: {\n          fontSize: 22,\n          lineHeight: 26,\n        },\n      },\n    }\n  }\n\n  _firstActive() {\n    this.tag('Text').text = `APP - v${this.version}\\nSDK - v${this.sdkVersion}`\n    this.tag('Text').loadTexture()\n    this.w = this.tag('Text').renderWidth + 40\n    this.h = this.tag('Text').renderHeight + 5\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../Lightning'\nimport Settings from '../Settings'\nimport Log from '../Log'\nexport default class FpsIndicator extends Lightning.Component {\n  static _template() {\n    return {\n      rect: true,\n      color: 0xffffffff,\n      texture: Lightning.Tools.getRoundRect(80, 80, 40),\n      h: 80,\n      w: 80,\n      x: 100,\n      y: 100,\n      mount: 1,\n      Background: {\n        x: 3,\n        y: 3,\n        texture: Lightning.Tools.getRoundRect(72, 72, 36),\n        color: 0xff008000,\n      },\n      Counter: {\n        w: w => w,\n        h: h => h,\n        y: 10,\n        text: {\n          fontSize: 32,\n          textAlign: 'center',\n        },\n      },\n      Text: {\n        w: w => w,\n        h: h => h,\n        y: 48,\n        text: {\n          fontSize: 15,\n          textAlign: 'center',\n          text: 'FPS',\n        },\n      },\n    }\n  }\n\n  _setup() {\n    this.config = {\n      ...{\n        log: false,\n        interval: 500,\n        threshold: 1,\n      },\n      ...Settings.get('platform', 'showFps'),\n    }\n\n    this.fps = 0\n    this.lastFps = this.fps - this.config.threshold\n\n    const fpsCalculator = () => {\n      this.fps = ~~(1 / this.stage.dt)\n    }\n    this.stage.on('frameStart', fpsCalculator)\n    this.stage.off('framestart', fpsCalculator)\n    this.interval = setInterval(this.showFps.bind(this), this.config.interval)\n  }\n\n  _firstActive() {\n    this.showFps()\n  }\n\n  _detach() {\n    clearInterval(this.interval)\n  }\n\n  showFps() {\n    if (Math.abs(this.lastFps - this.fps) <= this.config.threshold) return\n    this.lastFps = this.fps\n    // green\n    let bgColor = 0xff008000\n    // orange\n    if (this.fps <= 40 && this.fps > 20) bgColor = 0xffffa500\n    // red\n    else if (this.fps <= 20) bgColor = 0xffff0000\n\n    this.tag('Background').setSmooth('color', bgColor)\n    this.tag('Counter').text = `${this.fps}`\n\n    this.config.log && Log.info('FPS', this.fps)\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../Log'\nimport Utils from '../Utils'\n\nlet meta = {}\nlet translations = {}\nlet language = null\nlet dictionary = null\n\nexport const initLanguage = (file, language = null) => {\n  return new Promise((resolve, reject) => {\n    fetch(file)\n      .then(response => response.json())\n      .then(json => {\n        setTranslations(json)\n        // set language (directly or in a promise)\n        typeof language === 'object' && 'then' in language && typeof language.then === 'function'\n          ? language\n              .then(lang =>\n                setLanguage(lang)\n                  .then(resolve)\n                  .catch(reject)\n              )\n              .catch(e => {\n                Log.error(e)\n                reject(e)\n              })\n          : setLanguage(language)\n              .then(resolve)\n              .catch(reject)\n      })\n      .catch(() => {\n        const error = 'Language file ' + file + ' not found'\n        Log.error(error)\n        reject(error)\n      })\n  })\n}\n\nconst setTranslations = obj => {\n  if ('meta' in obj) {\n    meta = { ...obj.meta }\n    delete obj.meta\n  }\n  translations = obj\n}\n\nconst getLanguage = () => {\n  return language\n}\n\nconst setLanguage = lng => {\n  language = null\n  dictionary = null\n\n  return new Promise((resolve, reject) => {\n    if (lng in translations) {\n      language = lng\n    } else {\n      if ('map' in meta && lng in meta.map && meta.map[lng] in translations) {\n        language = meta.map[lng]\n      } else if ('default' in meta && meta.default in translations) {\n        const error =\n          'Translations for Language ' +\n          language +\n          ' not found. Using default language ' +\n          meta.default\n        Log.warn(error)\n        language = meta.default\n      } else {\n        const error = 'Translations for Language ' + language + ' not found.'\n        Log.error(error)\n        reject(error)\n      }\n    }\n\n    if (language) {\n      Log.info('Setting language to', language)\n\n      const translationsObj = translations[language]\n      if (typeof translationsObj === 'object') {\n        dictionary = translationsObj\n        resolve()\n      } else if (typeof translationsObj === 'string') {\n        const url = Utils.asset(translationsObj)\n\n        fetch(url)\n          .then(response => response.json())\n          .then(json => {\n            // save the translations for this language (to prevent loading twice)\n            translations[language] = json\n            dictionary = json\n            resolve()\n          })\n          .catch(e => {\n            const error = 'Error while fetching ' + url\n            Log.error(error, e)\n            reject(error)\n          })\n      }\n    }\n  })\n}\n\nexport default {\n  translate(key) {\n    let replacements = [...arguments].slice(1)\n\n    // no replacements so just translated string\n    if (replacements.length === 0) {\n      return (dictionary && dictionary[key]) || key\n    } else {\n      if (replacements.length === 1 && typeof replacements[0] === 'object') {\n        replacements = replacements.pop()\n      }\n\n      return Object.keys(\n        // maps array input to an object {0: 'item1', 1: 'item2'}\n        Array.isArray(replacements) ? Object.assign({}, replacements) : replacements\n      ).reduce((text, replacementKey) => {\n        return text.replace(\n          new RegExp('{\\\\s?' + replacementKey + '\\\\s?}', 'g'),\n          replacements[replacementKey]\n        )\n      }, (dictionary && dictionary[key]) || key)\n    }\n  },\n\n  translations(obj) {\n    setTranslations(obj)\n  },\n\n  set(language) {\n    return setLanguage(language)\n  },\n\n  get() {\n    return getLanguage()\n  },\n\n  available() {\n    const languageKeys = Object.keys(translations)\n    return languageKeys.map(key => ({ code: key, name: (meta.names && meta.names[key]) || key }))\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../Log'\n\nconst registry = {\n  eventListeners: [],\n  timeouts: [],\n  intervals: [],\n  targets: [],\n}\n\nexport default {\n  // Timeouts\n  setTimeout(cb, timeout, ...params) {\n    const timeoutId = setTimeout(\n      () => {\n        registry.timeouts = registry.timeouts.filter(id => id !== timeoutId)\n        cb.apply(null, params)\n      },\n      timeout,\n      params\n    )\n    Log.info('Set Timeout', 'ID: ' + timeoutId)\n    registry.timeouts.push(timeoutId)\n    return timeoutId\n  },\n\n  clearTimeout(timeoutId) {\n    if (registry.timeouts.indexOf(timeoutId) > -1) {\n      registry.timeouts = registry.timeouts.filter(id => id !== timeoutId)\n      Log.info('Clear Timeout', 'ID: ' + timeoutId)\n      clearTimeout(timeoutId)\n    } else {\n      Log.error('Clear Timeout', 'ID ' + timeoutId + ' not found')\n    }\n  },\n\n  clearTimeouts() {\n    registry.timeouts.forEach(timeoutId => {\n      this.clearTimeout(timeoutId)\n    })\n  },\n\n  // Intervals\n  setInterval(cb, interval, ...params) {\n    const intervalId = setInterval(\n      () => {\n        registry.intervals.filter(id => id !== intervalId)\n        cb.apply(null, params)\n      },\n      interval,\n      params\n    )\n    Log.info('Set Interval', 'ID: ' + intervalId)\n    registry.intervals.push(intervalId)\n    return intervalId\n  },\n\n  clearInterval(intervalId) {\n    if (registry.intervals.indexOf(intervalId) > -1) {\n      registry.intervals = registry.intervals.filter(id => id !== intervalId)\n      Log.info('Clear Interval', 'ID: ' + intervalId)\n      clearInterval(intervalId)\n    } else {\n      Log.error('Clear Interval', 'ID ' + intervalId + ' not found')\n    }\n  },\n\n  clearIntervals() {\n    registry.intervals.forEach(intervalId => {\n      this.clearInterval(intervalId)\n    })\n  },\n\n  // Event listeners\n  addEventListener(target, event, handler) {\n    target.addEventListener(event, handler)\n    const targetIndex =\n      registry.targets.indexOf(target) > -1\n        ? registry.targets.indexOf(target)\n        : registry.targets.push(target) - 1\n\n    registry.eventListeners[targetIndex] = registry.eventListeners[targetIndex] || {}\n    registry.eventListeners[targetIndex][event] = registry.eventListeners[targetIndex][event] || []\n    registry.eventListeners[targetIndex][event].push(handler)\n    Log.info(\n      'Add eventListener',\n      'Target:',\n      target,\n      'Event: ' + event,\n      'Handler:',\n      handler.toString()\n    )\n  },\n\n  removeEventListener(target, event, handler) {\n    const targetIndex = registry.targets.indexOf(target)\n    if (\n      targetIndex > -1 &&\n      registry.eventListeners[targetIndex] &&\n      registry.eventListeners[targetIndex][event] &&\n      registry.eventListeners[targetIndex][event].indexOf(handler) > -1\n    ) {\n      registry.eventListeners[targetIndex][event] = registry.eventListeners[targetIndex][\n        event\n      ].filter(fn => fn !== handler)\n      Log.info(\n        'Remove eventListener',\n        'Target:',\n        target,\n        'Event: ' + event,\n        'Handler:',\n        handler.toString()\n      )\n      target.removeEventListener(event, handler)\n    } else {\n      Log.error(\n        'Remove eventListener',\n        'Not found',\n        'Target',\n        target,\n        'Event: ' + event,\n        'Handler',\n        handler.toString()\n      )\n    }\n  },\n\n  // if `event` is omitted, removes all registered event listeners for target\n  // if `target` is also omitted, removes all registered event listeners\n  removeEventListeners(target, event) {\n    if (target && event) {\n      const targetIndex = registry.targets.indexOf(target)\n      if (targetIndex > -1) {\n        registry.eventListeners[targetIndex][event].forEach(handler => {\n          this.removeEventListener(target, event, handler)\n        })\n      }\n    } else if (target) {\n      const targetIndex = registry.targets.indexOf(target)\n      if (targetIndex > -1) {\n        Object.keys(registry.eventListeners[targetIndex]).forEach(_event => {\n          this.removeEventListeners(target, _event)\n        })\n      }\n    } else {\n      Object.keys(registry.eventListeners).forEach(targetIndex => {\n        this.removeEventListeners(registry.targets[targetIndex])\n      })\n    }\n  },\n\n  // Clear everything (to be called upon app close for proper cleanup)\n  clear() {\n    this.clearTimeouts()\n    this.clearIntervals()\n    this.removeEventListeners()\n    registry.eventListeners = []\n    registry.timeouts = []\n    registry.intervals = []\n    registry.targets = []\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const isObject = v => {\n  return typeof v === 'object' && v !== null\n}\n\nexport const isString = v => {\n  return typeof v === 'string'\n}\n\nexport const getRgbaComponents = argb => {\n  return {\n    r: ((argb / 65536) | 0) % 256,\n    g: ((argb / 256) | 0) % 256,\n    b: (argb * 1) % 256,\n    a: (argb / 16777216) | 0,\n  }\n}\n\nexport const limitWithinRange = (num, min, max) => {\n  return Math.min(Math.max(num, min), max)\n}\n\nexport const mergeColors = (c1, c2, p) => {\n  let r1 = ((c1 / 65536) | 0) % 256\n  let g1 = ((c1 / 256) | 0) % 256\n  let b1 = c1 % 256\n  let a1 = (c1 / 16777216) | 0\n  let r2 = ((c2 / 65536) | 0) % 256\n  let g2 = ((c2 / 256) | 0) % 256\n  let b2 = c2 % 256\n  let a2 = (c2 / 16777216) | 0\n  let r = r1 * p + r2 * (1 - p)\n  let g = g1 * p + g2 * (1 - p)\n  let b = b1 * p + b2 * (1 - p)\n  let a = a1 * p + a2 * (1 - p)\n  return Math.round(a) * 16777216 + Math.round(r) * 65536 + Math.round(g) * 256 + Math.round(b)\n}\n\nexport const calculateAlpha = (argb, p) => {\n  if (p > 1) {\n    p /= 100\n  } else if (p < 0) {\n    p = 0\n  }\n  let r = ((argb / 65536) | 0) % 256\n  let g = ((argb / 256) | 0) % 256\n  let b = argb % 256\n  return (r << 16) + (g << 8) + b + ((p * 255) | 0) * 16777216\n}\n\nexport const mergeColorAlpha = (c, alpha) => {\n  let a = (((c / 16777216) | 0) * alpha) | 0\n  return (\n    (((((c >> 16) & 0xff) * a) / 255) & 0xff) +\n    ((((c & 0xff00) * a) / 255) & 0xff00) +\n    (((((c & 0xff) << 16) * a) / 255) & 0xff0000) +\n    (a << 24)\n  )\n}\n\nconst getArgbNumber = rgba => {\n  rgba[0] = Math.max(0, Math.min(255, rgba[0]))\n  rgba[1] = Math.max(0, Math.min(255, rgba[1]))\n  rgba[2] = Math.max(0, Math.min(255, rgba[2]))\n  rgba[3] = Math.max(0, Math.min(255, rgba[3]))\n  let v = ((rgba[3] | 0) << 24) + ((rgba[0] | 0) << 16) + ((rgba[1] | 0) << 8) + (rgba[2] | 0)\n  if (v < 0) {\n    v = 0xffffffff + v + 1\n  }\n  return v\n}\n\nexport const argbToHsva = argb => {\n  const color = getRgbaComponents(argb)\n  let r = color.r / 255\n  let g = color.g / 255\n  let b = color.b / 255\n  let h = 0\n  let s = 0\n\n  const cMax = Math.max(r, g, b)\n  const cMin = Math.min(r, g, b)\n  const delta = cMax - cMin\n\n  //calculate hue\n  if (delta < 0.00001) {\n    h = 0\n  } else if (cMax !== 0 || cMin !== 0) {\n    if (r === cMax) {\n      h = (60 * ((g - b) / delta) + 360) % 360\n    } else if (g === cMax) {\n      h = (60 * ((b - r) / delta) + 120) % 360\n    } else if (b === cMax) {\n      h = (60 * ((r - g) / delta) + 240) % 360\n    }\n  }\n\n  //calc saturation\n  if (cMax > 0) {\n    s = delta / cMax\n  }\n  return {\n    h,\n    s,\n    v: cMax,\n    a: color.a / 255,\n  }\n}\n\nexport const hsvaToArgb = color => {\n  const h = color.h\n  const c = color.v * color.s\n  const m = color.v - c\n  const x = c * (1.0 - Math.abs(((h / 60) % 2) - 1))\n  let r = 0\n  let g = 0\n  let b = 0\n\n  if (0 <= h && h < 60) {\n    r = c\n    g = x\n  } else if (60 <= h && h < 120) {\n    r = x\n    g = c\n  } else if (120 <= h && h < 180) {\n    g = c\n    b = x\n  } else if (180 <= h && h < 240) {\n    g = x\n    b = c\n  } else if (240 <= h && h < 300) {\n    r = x\n    b = c\n  } else if (300 <= h && h < 360) {\n    r = c\n    b = x\n  }\n\n  r = Math.round((r + m) * 255.0)\n  g = Math.round((g + m) * 255.0)\n  b = Math.round((b + m) * 255.0)\n  return getArgbNumber([r, g, b, color.a * 255])\n}\n\nexport const argbToHSLA = argb => {\n  const col = getRgbaComponents(argb)\n  const r = col.r / 255\n  const g = col.g / 255\n  const b = col.b / 255\n\n  const max = Math.max(r, g, b)\n  const min = Math.min(r, g, b)\n\n  let h = 0\n  let s = 0\n  const l = (min + max) * 0.5\n  if (l > 0) {\n    const maxMin = max - min\n    if (maxMin > 0) {\n      const r2 = (max - r) / maxMin\n      const g2 = (max - g) / maxMin\n      const b2 = (max - b) / maxMin\n      if (l < 0.5) {\n        s = max + min\n      } else {\n        s = 2 - max - min\n      }\n\n      if (r === max && g === min) {\n        h = 5.0 + b2\n      } else if (r === max) {\n        h = 1.0 - g2\n      } else if (g === max && b === min) {\n        h = 1.0 + r2\n      } else if (g === max) {\n        h = 3.0 - b2\n      } else if (b === max) {\n        h = 3.0 + g2\n      } else {\n        h = 5.0 - r2\n      }\n      h = h / 6\n    }\n  }\n  return { h: h % 1, s, l, a: col.a }\n}\n\nexport const hslaToARGB = hsla => {\n  let r = 1\n  let g = 1\n  let b = 1\n\n  let h = hsla.h\n  let s = hsla.s\n  let l = hsla.l\n\n  if (h < 0) {\n    h += 1\n  }\n  let max = 0\n  if (l <= 0.5) {\n    max = l * (1.0 + s)\n  } else {\n    max = l + s - l * s\n  }\n\n  if (max > 0) {\n    h *= 6.0\n    const min = l + l - max\n    const minMax = (max - min) / max\n    const sextant = Math.floor(h)\n    const fract = h - sextant\n    const minMaxFract = max * minMax * fract\n    const mid1 = min + minMaxFract\n    const mid2 = max - minMaxFract\n\n    if (sextant === 0) {\n      r = max\n      g = mid1\n      b = min\n    }\n    if (sextant === 1) {\n      r = mid2\n      g = max\n      b = min\n    }\n    if (sextant === 2) {\n      r = min\n      g = max\n      b = mid1\n    }\n    if (sextant === 3) {\n      r = min\n      g = mid2\n      b = max\n    }\n    if (sextant === 4) {\n      r = mid1\n      g = min\n      b = max\n    }\n    if (sextant === 5) {\n      r = max\n      g = min\n      b = mid2\n    }\n  }\n  return getArgbNumber([Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255), hsla.a])\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../Log'\nimport { mergeColors, calculateAlpha, isObject, isString, argbToHSLA, hslaToARGB } from './utils.js'\n\nlet colors = {\n  white: '#ffffff',\n  black: '#000000',\n  red: '#ff0000',\n  green: '#00ff00',\n  blue: '#0000ff',\n  yellow: '#feff00',\n  cyan: '#00feff',\n  magenta: '#ff00ff',\n}\n\nconst normalizedColors = {\n  //store for normalized colors\n}\n\nconst addColors = (colorsToAdd, value) => {\n  if (isObject(colorsToAdd)) {\n    // clean up normalizedColors if they exist in the to be added colors\n    Object.keys(colorsToAdd).forEach(color => cleanUpNormalizedColors(color))\n    colors = Object.assign({}, colors, colorsToAdd)\n  } else if (isString(colorsToAdd) && value) {\n    cleanUpNormalizedColors(colorsToAdd)\n    colors[colorsToAdd] = value\n  }\n}\n\nconst cleanUpNormalizedColors = color => {\n  for (let c in normalizedColors) {\n    if (c.indexOf(color) > -1) {\n      delete normalizedColors[c]\n    }\n  }\n}\n\nexport const initColors = file => {\n  return new Promise((resolve, reject) => {\n    if (typeof file === 'object') {\n      addColors(file)\n      resolve()\n    }\n    fetch(file)\n      .then(response => response.json())\n      .then(json => {\n        addColors(json)\n        resolve()\n      })\n      .catch(() => {\n        const error = 'Colors file ' + file + ' not found'\n        Log.error(error)\n        reject(error)\n      })\n  })\n}\n\nconst normalizeColorToARGB = color => {\n  let targetColor = normalizedColors[color] || colors[color] || color\n  if (!targetColor) {\n    targetColor = color\n  }\n  const check = /^#([0-9A-F]{3}|[0-9A-F]{6})$/i\n  if (isString(targetColor) && check.test(targetColor)) {\n    let hex = check.exec(targetColor)[1]\n    if (hex.length === 3) {\n      hex = hex\n        .split('')\n        .map(value => {\n          return value + value\n        })\n        .join('')\n    }\n    targetColor = `0xff${hex}` * 1\n  }\n  if (!normalizedColors[color]) {\n    normalizedColors[color] = targetColor\n  }\n  return targetColor || 0xffffffff\n}\n\nexport default color => {\n  return Color.generate(color)\n}\n\nconst Color = {\n  color: null,\n  generate: function(value = this.color) {\n    if (normalizedColors[value]) {\n      this.color = normalizedColors[value]\n    } else {\n      this.color = normalizeColorToARGB(value)\n    }\n    return this\n  },\n  get() {\n    return this.color\n  },\n  alpha: function(percentage) {\n    this.color = calculateAlpha(this.color, Math.abs(percentage))\n    return this\n  },\n  darker(percentage) {\n    const hsl = argbToHSLA(this.color)\n    hsl.l = hsl.l * (1 - percentage)\n    this.color = hslaToARGB(hsl)\n    return this\n  },\n  lighter(percentage) {\n    const hsl = argbToHSLA(this.color)\n    hsl.l = hsl.l + (1 - hsl.l) * percentage\n    this.color = hslaToARGB(hsl)\n    return this\n  },\n  saturation(percentage) {\n    const hsl = argbToHSLA(this.color)\n    hsl.s = percentage\n    this.color = hslaToARGB(hsl)\n    return this\n  },\n  lightness(percentage) {\n    const hsl = argbToHSLA(this.color)\n    hsl.l = percentage\n    this.color = hslaToARGB(hsl)\n    return this\n  },\n  hue(degrees) {\n    const hsl = argbToHSLA(this.color)\n    hsl.h = degrees\n    this.color = hslaToARGB(hsl)\n    return this\n  },\n  mix(argb, p) {\n    this.color = mergeColors(this.color, argb, p)\n    return this\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Deepmerge from 'deepmerge'\nimport Lightning from '../Lightning'\nimport Locale from '../Locale'\nimport Metrics from '../Metrics'\nimport VersionLabel from '../VersionLabel'\nimport FpsCounter from '../FpsCounter'\nimport Log from '../Log'\nimport Settings from '../Settings'\nimport { initLanguage } from '../Language'\nimport Utils from '../Utils'\nimport Registry from '../Registry'\nimport { initColors } from '../Colors'\n\nimport { version as sdkVersion } from '../../package.json'\n\nexport let AppInstance\nexport let AppData\n\nconst defaultOptions = {\n  stage: { w: 1920, h: 1080, clearColor: 0x00000000, canvas2d: false },\n  debug: false,\n  defaultFontFace: 'RobotoRegular',\n  keys: {\n    8: 'Back',\n    13: 'Enter',\n    27: 'Menu',\n    37: 'Left',\n    38: 'Up',\n    39: 'Right',\n    40: 'Down',\n    174: 'ChannelDown',\n    175: 'ChannelUp',\n    178: 'Stop',\n    250: 'PlayPause',\n    191: 'Search', // Use \"/\" for keyboard\n    409: 'Search',\n  },\n}\n\nif (window.innerHeight === 720) {\n  defaultOptions.stage['w'] = 1280\n  defaultOptions.stage['h'] = 720\n  defaultOptions.stage['precision'] = 0.6666666667\n}\n\nconst customFontFaces = []\n\nconst fontLoader = (fonts, store) =>\n  new Promise((resolve, reject) => {\n    fonts\n      .map(({ family, url, urls, descriptors }) => () => {\n        const src = urls\n          ? urls.map(url => {\n              return 'url(' + url + ')'\n            })\n          : 'url(' + url + ')'\n        const fontFace = new FontFace(family, src, descriptors || {})\n        store.push(fontFace)\n        Log.info('Loading font', family)\n        document.fonts.add(fontFace)\n        return fontFace.load()\n      })\n      .reduce((promise, method) => {\n        return promise.then(() => method())\n      }, Promise.resolve(null))\n      .then(resolve)\n      .catch(reject)\n  })\n\nexport default function(App, appData, platformSettings) {\n  return class Application extends Lightning.Application {\n    constructor(options) {\n      const config = Deepmerge(defaultOptions, options)\n      super(config)\n      this.config = config\n    }\n\n    static _template() {\n      return {\n        w: 1920,\n        h: 1080,\n      }\n    }\n\n    _setup() {\n      Promise.all([\n        this.loadFonts((App.config && App.config.fonts) || (App.getFonts && App.getFonts()) || []),\n        // to be deprecated\n        Locale.load((App.config && App.config.locale) || (App.getLocale && App.getLocale())),\n        App.language && this.loadLanguage(App.language()),\n        App.colors && this.loadColors(App.colors()),\n      ])\n        .then(() => {\n          Metrics.app.loaded()\n\n          AppData = appData\n\n          AppInstance = this.stage.c({\n            ref: 'App',\n            type: App,\n            zIndex: 1,\n            forceZIndexContext: !!platformSettings.showVersion || !!platformSettings.showFps,\n          })\n\n          this.childList.a(AppInstance)\n\n          this._refocus()\n\n          Log.info('App version', this.config.version)\n          Log.info('SDK version', sdkVersion)\n\n          if (platformSettings.showVersion) {\n            this.childList.a({\n              ref: 'VersionLabel',\n              type: VersionLabel,\n              version: this.config.version,\n              sdkVersion: sdkVersion,\n              zIndex: 1,\n            })\n          }\n\n          if (platformSettings.showFps) {\n            this.childList.a({\n              ref: 'FpsCounter',\n              type: FpsCounter,\n              zIndex: 1,\n            })\n          }\n\n          super._setup()\n        })\n        .catch(console.error)\n    }\n\n    _handleBack() {\n      this.closeApp()\n    }\n\n    _handleExit() {\n      this.closeApp()\n    }\n\n    closeApp() {\n      Log.info('Signaling App Close')\n\n      if (platformSettings.onClose && typeof platformSettings.onClose === 'function') {\n        platformSettings.onClose(...arguments)\n      } else {\n        this.close()\n      }\n    }\n\n    close() {\n      Log.info('Closing App')\n\n      Settings.clearSubscribers()\n      Registry.clear()\n\n      this.childList.remove(this.tag('App'))\n      this.cleanupFonts()\n      // force texture garbage collect\n      this.stage.gc()\n      this.destroy()\n    }\n\n    loadFonts(fonts) {\n      return platformSettings.fontLoader && typeof platformSettings.fontLoader === 'function'\n        ? platformSettings.fontLoader(fonts, customFontFaces)\n        : fontLoader(fonts, customFontFaces)\n    }\n\n    cleanupFonts() {\n      if ('delete' in document.fonts) {\n        customFontFaces.forEach(fontFace => {\n          Log.info('Removing font', fontFace.family)\n          document.fonts.delete(fontFace)\n        })\n      } else {\n        Log.info('No support for removing manually-added fonts')\n      }\n    }\n\n    loadLanguage(config) {\n      let file = Utils.asset('translations.json')\n      let language = config\n\n      if (typeof language === 'object') {\n        language = config.language || null\n        file = config.file || file\n      }\n\n      return initLanguage(file, language)\n    }\n\n    loadColors(config) {\n      let file = Utils.asset('colors.json')\n      if (config && (typeof config === 'string' || typeof config === 'object')) {\n        file = config\n      }\n      return initColors(file)\n    }\n\n    set focus(v) {\n      this._focussed = v\n      this._refocus()\n    }\n\n    _getFocused() {\n      return this._focussed || this.tag('App')\n    }\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getConfigMap,\n  isArray,\n  isBoolean,\n  isComponentConstructor,\n  isFunction,\n  isPage,\n  symbols,\n  cleanHash,\n} from './helpers'\nimport { step, navigateQueue } from '../index'\nimport { createRoute, getOption } from './route'\nimport { createComponent } from './components'\nimport Log from '../../Log'\nimport { isWildcard } from './regex'\nimport emit from './emit'\nimport { updateWidgets } from './widgets'\nimport { setHistory, updateHistory } from './history'\nimport { AppInstance } from '../../Application'\n\n/**\n * @type {Lightning.Application}\n */\nexport let application\n\n/**\n * Actual instance of the app\n * @type {Lightning.Component}\n */\nexport let app\n\n/**\n * Component that hosts all routed pages\n * @type {Lightning.Component}\n */\nexport let pagesHost\n\n/**\n * @type {Lightning.Stage}\n */\nexport let stage\n\n/**\n * Platform driven Router configuration\n * @type {Map<string>}\n */\nexport let routerConfig\n\n/**\n * Component that hosts all attached widgets\n * @type {Lightning.Component}\n */\nexport let widgetsHost\n\n/**\n * Hash we point the browser to when we boot the app\n * and there is no deep-link provided\n * @type {string|Function}\n */\nlet rootHash\n\n/**\n * Boot request will fire before app start\n * can be used to execute some global logic\n * and can be configured\n */\nexport let bootRequest\n\n/**\n * Flag if we need to update the browser location hash.\n * Router can work without.\n * @type {boolean}\n */\nexport let updateHash = true\n\n/**\n * Will be called before a route starts, can be overridden\n * via routes config\n * @param from - route we came from\n * @param to - route we navigate to\n * @returns {Promise<*>}\n */\n// eslint-disable-next-line\nexport let beforeEachRoute = async (from, to)=>{\n  return true\n}\n\n/**\n *  * Will be called after a navigate successfully resolved,\n * can be overridden via routes config\n */\nexport let afterEachRoute = () => {}\n\n/**\n * All configured routes\n * @type {Map<string, object>}\n */\nexport let routes = new Map()\n\n/**\n * Store all page components per route\n * @type {Map<string, object>}\n */\nexport let components = new Map()\n\n/**\n * Flag if router has been initialised\n * @type {boolean}\n */\nlet initialised = false\n\n/**\n * Current page being rendered on screen\n * @type {null}\n */\nlet activePage = null\nlet activeHash\nlet activeRoute\n\n/**\n *  During the process of a navigation request a new\n *  request can start, to prevent unwanted behaviour\n *  the navigate()-method stores the last accepted hash\n *  so we can invalidate any prior requests\n */\nlet lastAcceptedHash\n\n/**\n * With on()-data providing behaviour the Router forced the App\n * in a Loading state. When the data-provider resolves we want to\n * change the state back to where we came from\n */\nlet previousState\n\nconst mixin = app => {\n  // by default the Router Baseclass provides the component\n  // reference in which we store our pages\n  if (app.pages) {\n    pagesHost = app.pages.childList\n  }\n  // if the app is using widgets we grab refs\n  // and hide all the widgets\n  if (app.widgets && app.widgets.children) {\n    widgetsHost = app.widgets.childList\n    // hide all widgets on boot\n    widgetsHost.forEach(w => (w.visible = false))\n  }\n  app._handleBack = e => {\n    step(-1)\n    e.preventDefault()\n  }\n}\n\nexport const bootRouter = (config, instance) => {\n  let { appInstance, routes } = config\n\n  // if instance is provided and it's and Lightning Component instance\n  if (instance && isPage(instance)) {\n    app = instance\n  }\n  if (!app) {\n    app = appInstance || AppInstance\n  }\n\n  application = app.application\n  pagesHost = application.childList\n  stage = app.stage\n  routerConfig = getConfigMap()\n\n  mixin(app)\n\n  if (isArray(routes)) {\n    setup(config)\n  } else if (isFunction(routes)) {\n    console.warn('[Router]: Calling Router.route() directly is deprecated.')\n    console.warn(\n      'Use object config: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration'\n    )\n  }\n}\n\nconst setup = config => {\n  if (!initialised) {\n    init(config)\n  }\n  config.routes.forEach(r => {\n    const path = cleanHash(r.path)\n    if (!routeExists(path)) {\n      const route = createRoute(r)\n      routes.set(path, route)\n      // if route has a configured component property\n      // we store it in a different map to simplify\n      // the creating and destroying per route\n      if (route.component) {\n        let type = route.component\n        if (isComponentConstructor(type)) {\n          if (!routerConfig.get('lazyCreate')) {\n            type = createComponent(stage, type)\n            pagesHost.a(type)\n          }\n        }\n        components.set(path, type)\n      }\n    } else {\n      console.error(`${path} already exists in routes configuration`)\n    }\n  })\n}\n\nconst init = config => {\n  rootHash = config.root\n  if (isFunction(config.boot)) {\n    bootRequest = config.boot\n  }\n  if (isBoolean(config.updateHash)) {\n    updateHash = config.updateHash\n  }\n  if (isFunction(config.beforeEachRoute)) {\n    beforeEachRoute = config.beforeEachRoute\n  }\n  if (isFunction(config.afterEachRoute)) {\n    afterEachRoute = config.afterEachRoute\n  }\n  if (config.bootComponent) {\n    console.warn(\n      '[Router]: Boot Component is now available as a special router: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration?id=special-routes'\n    )\n    console.warn(\n      '[Router]: setting { bootComponent } property will be deprecated in a future release'\n    )\n    if (isPage(config.bootComponent)) {\n      config.routes.push({\n        path: '$',\n        component: config.bootComponent,\n        // we try to assign the bootRequest as after data-provider\n        // so it will behave as any other component\n        after: bootRequest || null,\n        options: {\n          preventStorage: true,\n        },\n      })\n    } else {\n      console.error(`[Router]: ${config.bootComponent} is not a valid boot component`)\n    }\n  }\n  initialised = true\n}\n\nexport const storeComponent = (route, type) => {\n  if (components.has(route)) {\n    components.set(route, type)\n  }\n}\n\nexport const getComponent = route => {\n  if (components.has(route)) {\n    return components.get(route)\n  }\n  return null\n}\n/**\n * Test if router needs to update browser location hash\n * @returns {boolean}\n */\nexport const mustUpdateLocationHash = () => {\n  if (!routerConfig || !routerConfig.size) {\n    return false\n  }\n  // we need support to either turn change hash off\n  // per platform or per app\n  const updateConfig = routerConfig.get('updateHash')\n  return !((isBoolean(updateConfig) && !updateConfig) || (isBoolean(updateHash) && !updateHash))\n}\n\n/**\n * Will be called when a new navigate() request has completed\n * and has not been expired due to it's async nature\n * @param request\n */\nexport const onRequestResolved = request => {\n  const hash = request.hash\n  const route = request.route\n  const register = request.register\n  const page = request.page\n\n  // clean up history if modifier is set\n  if (getOption(route.options, 'clearHistory')) {\n    setHistory([])\n  } else if (hash && !isWildcard.test(route.path)) {\n    updateHistory(request)\n  }\n\n  // we only update the stackLocation if a route\n  // is not expired before it resolves\n  storeComponent(route.path, page)\n\n  if (request.isSharedInstance || !request.isCreated) {\n    emit(page, 'changed')\n  } else if (request.isCreated) {\n    emit(page, 'mounted')\n  }\n\n  // only update widgets if we have a host\n  if (widgetsHost) {\n    updateWidgets(route.widgets, page)\n  }\n\n  // we want to clean up if there is an\n  // active page that is not being shared\n  // between current and previous route\n  if (getActivePage() && !request.isSharedInstance) {\n    cleanUp(activePage, request)\n  }\n\n  // provide history object to active page\n  if (register.get(symbols.historyState) && isFunction(page.historyState)) {\n    page.historyState(register.get(symbols.historyState))\n  }\n\n  setActivePage(page)\n\n  activeHash = request.hash\n  activeRoute = route.path\n\n  // cleanup all cancelled requests\n  for (let request of navigateQueue.values()) {\n    if (request.isCancelled && request.hash) {\n      navigateQueue.delete(request.hash)\n    }\n  }\n\n  afterEachRoute(request)\n\n  Log.info('[route]:', route.path)\n  Log.info('[hash]:', hash)\n}\n\nconst cleanUp = (page, request) => {\n  const route = activeRoute\n  const register = request.register\n  const lazyDestroy = routerConfig.get('lazyDestroy')\n  const destroyOnBack = routerConfig.get('destroyOnHistoryBack')\n  const keepAlive = register.get('keepAlive')\n  const isFromHistory = register.get(symbols.backtrack)\n\n  let doCleanup = false\n\n  // if this request is executed due to a step back in history\n  // and we have configured to destroy active page when we go back\n  // in history or lazyDestory is enabled\n  if (isFromHistory && (destroyOnBack || lazyDestroy)) {\n    doCleanup = true\n  }\n\n  // clean up if lazyDestroy is enabled and the keepAlive flag\n  // in navigation register is false\n  if (lazyDestroy && !keepAlive) {\n    doCleanup = true\n  }\n\n  // if the current and new request share the same route blueprint\n  if (activeRoute === request.route.path) {\n    doCleanup = true\n  }\n\n  if (doCleanup) {\n    // grab original class constructor if\n    // statemachine routed else store constructor\n    storeComponent(route, page._routedType || page.constructor)\n\n    // actual remove of page from memory\n    pagesHost.remove(page)\n\n    // force texture gc() if configured\n    // so we can cleanup textures in the same tick\n    if (routerConfig.get('gcOnUnload')) {\n      stage.gc()\n    }\n  } else {\n    // If we're not removing the page we need to\n    // reset it's properties\n    page.patch({\n      x: 0,\n      y: 0,\n      scale: 1,\n      alpha: 1,\n      visible: false,\n    })\n  }\n}\n\nexport const getActiveHash = () => {\n  return activeHash\n}\n\nexport const setActiveHash = hash => {\n  activeHash = hash\n}\n\nexport const setActivePage = page => {\n  activePage = page\n}\n\nexport const getActivePage = () => {\n  return activePage\n}\n\nexport const getActiveRoute = () => {\n  return activeRoute\n}\n\nexport const getLastHash = () => {\n  return lastAcceptedHash\n}\n\nexport const setLastHash = hash => {\n  lastAcceptedHash = hash\n}\n\nexport const setPreviousState = state => {\n  previousState = state\n}\n\nexport const getPreviousState = () => {\n  return previousState\n}\n\nexport const routeExists = key => {\n  return routes.has(key)\n}\n\nexport const getRootHash = () => {\n  return rootHash\n}\n\nexport const getBootRequest = () => {\n  return bootRequest\n}\n\nexport const getRouterConfig = () => {\n  return routerConfig\n}\n\nexport const getRoutes = () => {\n  return routes\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../../Lightning'\nimport Settings from '../../Settings'\nimport { getActiveHash } from './router'\nimport { getResumeHash } from '../index'\n\nexport const isFunction = v => {\n  return typeof v === 'function'\n}\n\nexport const isObject = v => {\n  return typeof v === 'object' && v !== null\n}\n\nexport const isBoolean = v => {\n  return typeof v === 'boolean'\n}\n\nexport const isPage = v => {\n  if (v instanceof Lightning.Element || isComponentConstructor(v)) {\n    return true\n  }\n  return false\n}\n\nexport const isComponentConstructor = type => {\n  return type.prototype && 'isComponent' in type.prototype\n}\n\nexport const isArray = v => {\n  return Array.isArray(v)\n}\n\nexport const ucfirst = v => {\n  return `${v.charAt(0).toUpperCase()}${v.slice(1)}`\n}\n\nexport const isString = v => {\n  return typeof v === 'string'\n}\n\nexport const isPromise = method => {\n  let result\n  if (isFunction(method)) {\n    try {\n      result = method.apply(null)\n    } catch (e) {\n      result = e\n    }\n  } else {\n    result = method\n  }\n  return isObject(result) && isFunction(result.then)\n}\n\nexport const cleanHash = (hash = '') => {\n  return hash.replace(/^#/, '').replace(/\\/+$/, '')\n}\n\nexport const getConfigMap = () => {\n  const routerSettings = Settings.get('platform', 'router')\n  const isObj = isObject(routerSettings)\n  return [\n    'backtrack',\n    'gcOnUnload',\n    'destroyOnHistoryBack',\n    'lazyCreate',\n    'lazyDestroy',\n    'reuseInstance',\n    'autoRestoreRemote',\n    'numberNavigation',\n    'updateHash',\n    'storeSameHash',\n  ].reduce((config, key) => {\n    config.set(key, isObj ? routerSettings[key] : Settings.get('platform', key))\n    return config\n  }, new Map())\n}\n\nexport const incorrectParams = (cb, route) => {\n  const isIncorrect = /^\\w*?\\s?\\(\\s?\\{.*?\\}\\s?\\)/i\n  if (isIncorrect.test(cb.toString())) {\n    console.warn(\n      [\n        `DEPRECATION: The data-provider for route: ${route} is not correct.`,\n        '\"page\" is no longer a property of the params object but is now the first function parameter: ',\n        'https://github.com/rdkcentral/Lightning-SDK/blob/feature/router/docs/plugins/router/dataproviding.md#data-providing',\n        \"It's supported for now but will be removed in a future release.\",\n      ].join('\\n')\n    )\n    return true\n  }\n  return false\n}\n\nexport const getQueryStringParams = (hash = getActiveHash()) => {\n  const resumeHash = getResumeHash()\n  if (hash === '$' || resumeHash) {\n    if (isString(resumeHash)) {\n      hash = resumeHash\n    }\n  }\n\n  let parse = ''\n  const getQuery = /([?&].*)/\n  const matches = getQuery.exec(hash)\n  const params = {}\n\n  if (document.location && document.location.search) {\n    parse = document.location.search\n  }\n\n  if (matches && matches.length) {\n    let hashParams = matches[1]\n    if (parse) {\n      // if location.search is not empty we\n      // remove the leading ? to create a\n      // valid string\n      hashParams = hashParams.replace(/^\\?/, '')\n      // we parse hash params last so they we can always\n      // override search params with hash params\n      parse = `${parse}&${hashParams}`\n    } else {\n      parse = hashParams\n    }\n  }\n\n  if (parse) {\n    const urlParams = new URLSearchParams(parse)\n    for (const [key, value] of urlParams.entries()) {\n      params[key] = value\n    }\n    return params\n  } else {\n    return false\n  }\n}\n\nexport const objectToQueryString = obj => {\n  if (!isObject(obj)) {\n    return ''\n  }\n  return (\n    '?' +\n    Object.keys(obj)\n      .map(key => {\n        return `${key}=${obj[key]}`\n      })\n      .join('&')\n  )\n}\n\nexport const symbols = {\n  route: Symbol('route'),\n  hash: Symbol('hash'),\n  store: Symbol('store'),\n  fromHistory: Symbol('fromHistory'),\n  expires: Symbol('expires'),\n  resume: Symbol('resume'),\n  backtrack: Symbol('backtrack'),\n  historyState: Symbol('historyState'),\n  queryParams: Symbol('queryParams'),\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { symbols, getQueryStringParams } from './helpers'\nimport { app, routes, routeExists } from './router'\nimport { getValuesFromHash } from './route'\nimport emit from './emit'\n\nexport let previousState\n\nexport const dataHooks = {\n  on: request => {\n    previousState = app.state || ''\n    app._setState('Loading')\n    return execProvider(request)\n  },\n  before: request => {\n    return execProvider(request)\n  },\n  after: request => {\n    try {\n      execProvider(request, true)\n    } catch (e) {\n      // for now we fail silently\n    }\n    return Promise.resolve()\n  },\n}\n\nconst execProvider = (request, emitProvided) => {\n  const route = request.route\n  const provider = route.provider\n  const expires = route.cache ? route.cache * 1000 : 0\n  const params = addPersistData(request)\n  return provider.request(request.page, { ...params }).then(() => {\n    request.page[symbols.expires] = Date.now() + expires\n    if (emitProvided) {\n      emit(request.page, 'dataProvided')\n    }\n  })\n}\n\nexport const addPersistData = ({ page, route, hash, register = new Map() }) => {\n  const urlValues = getValuesFromHash(hash, route.path)\n  const queryParams = getQueryStringParams(hash)\n  const pageData = new Map([...urlValues, ...register])\n  const params = {}\n\n  // make dynamic url data available to the page\n  // as instance properties\n  for (let [name, value] of pageData) {\n    params[name] = value\n  }\n\n  if (queryParams) {\n    params[symbols.queryParams] = queryParams\n  }\n\n  // check navigation register for persistent data\n  if (register.size) {\n    const obj = {}\n    for (let [k, v] of register) {\n      obj[k] = v\n    }\n    page.persist = obj\n  }\n\n  // make url data and persist data available\n  // via params property\n  page.params = params\n  emit(page, ['urlParams'], params)\n\n  return params\n}\n\n/**\n * Test if page passed cache-time\n * @param page\n * @returns {boolean}\n */\nexport const isPageExpired = page => {\n  if (!page[symbols.expires]) {\n    return false\n  }\n\n  const expires = page[symbols.expires]\n  const now = Date.now()\n\n  return now >= expires\n}\n\nexport const hasProvider = path => {\n  if (routeExists(path)) {\n    const record = routes.get(path)\n    return !!record.provider\n  }\n  return false\n}\n\nexport const getProvider = route => {\n  // @todo: fix, route already is passed in\n  if (routeExists(route.path)) {\n    const { provider } = routes.get(route.path)\n    return {\n      type: provider.type,\n      provider: provider.request,\n    }\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst fade = (i, o) => {\n  return new Promise(resolve => {\n    i.patch({\n      alpha: 0,\n      visible: true,\n      smooth: {\n        alpha: [1, { duration: 0.5, delay: 0.1 }],\n      },\n    })\n    // resolve on y finish\n    i.transition('alpha').on('finish', () => {\n      if (o) {\n        o.visible = false\n      }\n      resolve()\n    })\n  })\n}\n\nconst crossFade = (i, o) => {\n  return new Promise(resolve => {\n    i.patch({\n      alpha: 0,\n      visible: true,\n      smooth: {\n        alpha: [1, { duration: 0.5, delay: 0.1 }],\n      },\n    })\n    if (o) {\n      o.patch({\n        smooth: {\n          alpha: [0, { duration: 0.5, delay: 0.3 }],\n        },\n      })\n    }\n    // resolve on y finish\n    i.transition('alpha').on('finish', () => {\n      resolve()\n    })\n  })\n}\n\nconst moveOnAxes = (axis, direction, i, o) => {\n  const bounds = axis === 'x' ? 1920 : 1080\n  return new Promise(resolve => {\n    i.patch({\n      [`${axis}`]: direction ? bounds * -1 : bounds,\n      visible: true,\n      smooth: {\n        [`${axis}`]: [0, { duration: 0.4, delay: 0.2 }],\n      },\n    })\n    // out is optional\n    if (o) {\n      o.patch({\n        [`${axis}`]: 0,\n        smooth: {\n          [`${axis}`]: [direction ? bounds : bounds * -1, { duration: 0.4, delay: 0.2 }],\n        },\n      })\n    }\n    // resolve on y finish\n    i.transition(axis).on('finish', () => {\n      resolve()\n    })\n  })\n}\n\nconst up = (i, o) => {\n  return moveOnAxes('y', 0, i, o)\n}\n\nconst down = (i, o) => {\n  return moveOnAxes('y', 1, i, o)\n}\n\nconst left = (i, o) => {\n  return moveOnAxes('x', 0, i, o)\n}\n\nconst right = (i, o) => {\n  return moveOnAxes('x', 1, i, o)\n}\n\nexport default {\n  fade,\n  crossFade,\n  up,\n  down,\n  left,\n  right,\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getRouterConfig } from './router'\nimport { isPromise, isString } from './helpers'\nimport Transitions from '../transitions'\n\n/**\n * execute transition between new / old page and\n * toggle the defined widgets\n * @todo: platform override default transition\n * @param pageIn\n * @param pageOut\n */\nexport const executeTransition = (pageIn, pageOut = null) => {\n  const transition = pageIn.pageTransition || pageIn.easing\n  const hasCustomTransitions = !!(pageIn.smoothIn || pageIn.smoothInOut || transition)\n  const transitionsDisabled = getRouterConfig().get('disableTransitions')\n\n  if (pageIn.easing) {\n    console.warn('easing() method is deprecated and will be removed. Use pageTransition()')\n  }\n\n  // default behaviour is a visibility toggle\n  if (!hasCustomTransitions || transitionsDisabled) {\n    pageIn.visible = true\n    if (pageOut) {\n      pageOut.visible = false\n    }\n    return Promise.resolve()\n  }\n\n  if (transition) {\n    let type\n    try {\n      type = transition.call(pageIn, pageIn, pageOut)\n    } catch (e) {\n      type = 'crossFade'\n    }\n\n    if (isPromise(type)) {\n      return type\n    }\n\n    if (isString(type)) {\n      const fn = Transitions[type]\n      if (fn) {\n        return fn(pageIn, pageOut)\n      }\n    }\n\n    // keep backwards compatible for now\n    if (pageIn.smoothIn) {\n      // provide a smooth function that resolves itself\n      // on transition finish\n      const smooth = (p, v, args = {}) => {\n        return new Promise(resolve => {\n          pageIn.visible = true\n          pageIn.setSmooth(p, v, args)\n          pageIn.transition(p).on('finish', () => {\n            resolve()\n          })\n        })\n      }\n      return pageIn.smoothIn({ pageIn, smooth })\n    }\n  }\n  return Transitions.crossFade(pageIn, pageOut)\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  app,\n  getComponent,\n  onRequestResolved,\n  getLastHash,\n  pagesHost,\n  stage,\n  getPreviousState,\n  getActivePage,\n  routerConfig,\n  routeExists,\n} from './router'\n\nimport Log from '../../Log'\nimport { isBoolean, isComponentConstructor, isFunction, symbols } from './helpers'\nimport { getProvider, hasProvider, isPageExpired, dataHooks, addPersistData } from './provider'\nimport { createComponent } from './components'\nimport { executeTransition } from './transition'\nimport { getActiveWidget } from './widgets'\nimport emit from './emit'\nimport { getOption } from './route'\nimport { navigate } from '../index'\nimport { setHistory, updateHistory } from './history'\nimport { isWildcard } from './regex'\n\n/**\n * The actual loading of the component\n * */\nexport const load = async request => {\n  let expired = false\n  try {\n    request = await loader(request)\n    if (request && !request.isCancelled) {\n      // in case of on() providing we need to reset\n      // app state;\n      if (app.state === 'Loading') {\n        if (getPreviousState() === 'Widgets') {\n          app._setState('Widgets', [getActiveWidget()])\n        } else {\n          app._setState('')\n        }\n      }\n      // Do page transition if instance\n      // is not shared between the routes\n      if (!request.isSharedInstance && !request.isCancelled) {\n        await executeTransition(request.page, getActivePage())\n      }\n    } else {\n      expired = true\n    }\n    // on expired we only cleanup\n    if (expired || request.isCancelled) {\n      Log.debug('[router]:', `Rejected ${request.hash} because route to ${getLastHash()} started`)\n      if (request.isCreated && !request.isSharedInstance) {\n        // remove from render-tree\n        pagesHost.remove(request.page)\n      }\n    } else {\n      onRequestResolved(request)\n      // resolve promise\n      return request.page\n    }\n  } catch (request) {\n    if (!request.route) {\n      console.error(request)\n    } else if (!expired) {\n      // @todo: revisit\n      const { route } = request\n      // clean up history if modifier is set\n      if (getOption(route.options, 'clearHistory')) {\n        setHistory([])\n      } else if (!isWildcard.test(route.path)) {\n        updateHistory(request)\n      }\n\n      if (request.isCreated && !request.isSharedInstance) {\n        // remove from render-tree\n        pagesHost.remove(request.page)\n      }\n      handleError(request)\n    }\n  }\n}\n\nconst loader = async request => {\n  const route = request.route\n  const hash = request.hash\n  const register = request.register\n\n  // todo: grab from Route instance\n  let type = getComponent(route.path)\n  let isConstruct = isComponentConstructor(type)\n  let provide = false\n\n  // if it's an instance bt we're not coming back from\n  // history we test if we can re-use this instance\n  if (!isConstruct && !register.get(symbols.backtrack)) {\n    if (!mustReuse(route)) {\n      type = type.constructor\n      isConstruct = true\n    }\n  }\n\n  // If page is Lightning Component instance\n  if (!isConstruct) {\n    request.page = type\n    // if we have have a data route for current page\n    if (hasProvider(route.path)) {\n      if (isPageExpired(type) || type[symbols.hash] !== hash) {\n        provide = true\n      }\n    }\n    let currentRoute = getActivePage() && getActivePage()[symbols.route]\n    // if the new route is equal to the current route it means that both\n    // route share the Component instance and stack location / since this case\n    // is conflicting with the way before() and after() loading works we flag it,\n    // and check platform settings in we want to re-use instance\n    if (route.path === currentRoute) {\n      request.isSharedInstance = true\n      // since we're re-using the instance we must attach\n      // historyState to the request to prevent it from\n      // being overridden.\n      if (isFunction(request.page.historyState)) {\n        request.copiedHistoryState = request.page.historyState()\n      }\n    }\n  } else {\n    request.page = createComponent(stage, type)\n    pagesHost.a(request.page)\n    // test if need to request data provider\n    if (hasProvider(route.path)) {\n      provide = true\n    }\n    request.isCreated = true\n  }\n\n  // we store hash and route as properties on the page instance\n  // that way we can easily calculate new behaviour on page reload\n  request.page[symbols.hash] = hash\n  request.page[symbols.route] = route.path\n\n  try {\n    if (provide) {\n      // extract attached data-provider for route\n      // we're processing\n      const { type: loadType, provider } = getProvider(route)\n\n      // update running request\n      request.provider = provider\n      request.providerType = loadType\n\n      await dataHooks[loadType](request)\n\n      // we early exit if the current request is expired\n      if (hash !== getLastHash()) {\n        return false\n      } else {\n        if (request.providerType !== 'after') {\n          emit(request.page, 'dataProvided')\n        }\n        // resolve promise\n        return request\n      }\n    } else {\n      addPersistData(request)\n      return request\n    }\n  } catch (e) {\n    request.error = e\n    return Promise.reject(request)\n  }\n}\n\nconst handleError = request => {\n  if (request && request.error) {\n    console.error(request.error)\n  } else if (request) {\n    Log.error(request)\n  }\n\n  if (request.page && routeExists('!')) {\n    navigate('!', { request }, false)\n  }\n}\n\nexport const mustReuse = route => {\n  const opt = getOption(route.options, 'reuseInstance')\n  const config = routerConfig.get('reuseInstance')\n\n  // route always has final decision\n  if (isBoolean(opt)) {\n    return opt\n  }\n  return !(isBoolean(config) && config === false)\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../Lightning'\nimport { default as Router } from './index'\nimport { routerConfig } from './utils/router.js'\nimport { isBoolean } from './utils/helpers'\n\nexport class RoutedApp extends Lightning.Component {\n  static _template() {\n    return {\n      Pages: {\n        forceZIndexContext: true,\n      },\n      /**\n       * This is a default Loading page that will be made visible\n       * during data-provider on() you CAN override in child-class\n       */\n      Loading: {\n        rect: true,\n        w: 1920,\n        h: 1080,\n        color: 0xff000000,\n        visible: false,\n        zIndex: 99,\n        Label: {\n          mount: 0.5,\n          x: 960,\n          y: 540,\n          text: {\n            text: 'Loading..',\n          },\n        },\n      },\n    }\n  }\n\n  static _states() {\n    return [\n      class Loading extends this {\n        $enter() {\n          this.tag('Loading').visible = true\n        }\n\n        $exit() {\n          this.tag('Loading').visible = false\n        }\n      },\n      class Widgets extends this {\n        $enter(args, widget) {\n          // store widget reference\n          this._widget = widget\n\n          // since it's possible that this behaviour\n          // is non-remote driven we force a recalculation\n          // of the focuspath\n          this._refocus()\n        }\n\n        _getFocused() {\n          // we delegate focus to selected widget\n          // so it can consume remotecontrol presses\n          return this._widget\n        }\n\n        // if we want to widget to widget focus delegation\n        reload(widget) {\n          this._widget = widget\n          this._refocus()\n        }\n\n        _handleKey() {\n          const restoreFocus = routerConfig.get('autoRestoreRemote')\n          /**\n           * The Router used to delegate focus back to the page instance on\n           * every unhandled key. This is barely usefull in any situation\n           * so for now we offer the option to explicity turn that behaviour off\n           * so we don't don't introduce a breaking change.\n           */\n          if (!isBoolean(restoreFocus) || restoreFocus === true) {\n            Router.focusPage()\n          }\n        }\n      },\n    ]\n  }\n\n  /**\n   * Return location where pages need to be stored\n   */\n  get pages() {\n    return this.tag('Pages')\n  }\n\n  /**\n   * Tell router where widgets are stored\n   */\n  get widgets() {\n    return this.tag('Widgets')\n  }\n\n  /**\n   * we MUST register _handleBack method so the Router\n   * can override it\n   * @private\n   */\n  _handleBack() {}\n\n  /**\n   * We MUST return Router.activePage() so the new Page\n   * can listen to the remote-control.\n   */\n  _getFocused() {\n    return Router.getActivePage()\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  isFunction,\n  isPage,\n  isObject,\n  isBoolean,\n  isString,\n  getQueryStringParams,\n  symbols,\n  cleanHash,\n} from './utils/helpers'\n\nimport {\n  bootRouter,\n  routeExists,\n  getRootHash,\n  getBootRequest,\n  mustUpdateLocationHash,\n  getComponent,\n  storeComponent,\n  stage,\n  app,\n  routerConfig,\n  setLastHash,\n  getActivePage,\n  beforeEachRoute,\n  getActiveHash,\n  getActiveRoute,\n} from './utils/router'\n\nimport { focusWidget, getActiveWidget, restoreFocus } from './utils/widgets'\nimport { getHistory, setHistory, getHistoryState, replaceHistoryState } from './utils/history'\nimport {\n  createRequest,\n  getRouteByHash,\n  getValuesFromHash,\n  getFloor,\n  getHashByName,\n  keepActivePageAlive,\n} from './utils/route'\nimport { load } from './utils/loader'\nimport { stripRegex, isWildcard } from './utils/regex'\nimport { RoutedApp } from './base'\nimport Registry from '../Registry'\n\n/*\nrouThor ==[x]\n */\nexport let navigateQueue = new Map()\nlet forcedHash = ''\nlet resumeHash = ''\n\n/**\n * Start routing the app\n * @param config - route config object\n * @param instance - instance of the app\n */\nconst startRouter = (config, instance) => {\n  bootRouter(config, instance)\n  registerListener()\n  start()\n}\n\n// start translating url\nconst start = () => {\n  let hash = (getHash() || '').replace(/^#/, '')\n  const bootKey = '$'\n  const params = getQueryStringParams(hash)\n  const bootRequest = getBootRequest()\n  const rootHash = getRootHash()\n  const isDirectLoad = hash.indexOf(bootKey) !== -1\n\n  // prevent direct reload of wildcard routes\n  // expect bootComponent\n  if (isWildcard.test(hash) && hash !== bootKey) {\n    hash = ''\n  }\n\n  // store resume point for manual resume\n  resumeHash = isDirectLoad ? rootHash : hash || rootHash\n\n  const ready = () => {\n    if (!hash && rootHash) {\n      if (isString(rootHash)) {\n        navigate(rootHash)\n      } else if (isFunction(rootHash)) {\n        rootHash().then(res => {\n          if (isObject(res)) {\n            navigate(res.path, res.params)\n          } else {\n            navigate(res)\n          }\n        })\n      }\n    } else {\n      queue(hash)\n      handleHashChange()\n        .then(() => {\n          app._refocus()\n        })\n        .catch(e => {\n          console.error(e)\n        })\n    }\n  }\n\n  if (routeExists(bootKey)) {\n    if (hash && !isDirectLoad) {\n      if (!getRouteByHash(hash)) {\n        navigate('*', { failedHash: hash })\n        return\n      }\n    }\n    navigate(\n      bootKey,\n      {\n        resume: resumeHash,\n        reload: bootKey === hash,\n      },\n      false\n    )\n  } else if (isFunction(bootRequest)) {\n    bootRequest(params)\n      .then(() => {\n        ready()\n      })\n      .catch(e => {\n        handleBootError(e)\n      })\n  } else {\n    ready()\n  }\n}\n\nconst handleBootError = e => {\n  if (routeExists('!')) {\n    navigate('!', { request: { error: e } })\n  } else {\n    console.error(e)\n  }\n}\n\n/**\n * start a new request\n * @param url\n * @param args\n * @param store\n */\nexport const navigate = (url, args = {}, store) => {\n  if (isObject(url)) {\n    url = getHashByName(url)\n    if (!url) {\n      return\n    }\n  }\n\n  let hash = getHash()\n  if (!mustUpdateLocationHash() && forcedHash) {\n    hash = forcedHash\n  }\n  if (hash.replace(/^#/, '') !== url) {\n    // push request in the queue\n    queue(url, args, store)\n\n    setHash(url)\n    if (!mustUpdateLocationHash()) {\n      forcedHash = url\n      handleHashChange(url)\n        .then(() => {\n          app._refocus()\n        })\n        .catch(e => {\n          console.error(e)\n        })\n    }\n  } else if (args.reload) {\n    // push request in the queue\n    queue(url, args, store)\n\n    handleHashChange(url)\n      .then(() => {\n        app._refocus()\n      })\n      .catch(e => {\n        console.error(e)\n      })\n  }\n}\n\nconst queue = (hash, args = {}, store) => {\n  hash = cleanHash(hash)\n  if (!navigateQueue.has(hash)) {\n    for (let request of navigateQueue.values()) {\n      request.cancel()\n    }\n    const request = createRequest(hash, args, store)\n    navigateQueue.set(decodeURIComponent(hash), request)\n\n    return request\n  }\n  return false\n}\n\n/**\n * Handle change of hash\n * @param override\n * @returns {Promise<void>}\n */\nconst handleHashChange = async override => {\n  const hash = cleanHash(override || getHash())\n  const queueId = decodeURIComponent(hash)\n  let request = navigateQueue.get(queueId)\n\n  // handle hash updated manually\n  if (!request && !navigateQueue.size) {\n    request = queue(hash)\n  }\n\n  const route = getRouteByHash(hash)\n\n  if (!route) {\n    if (routeExists('*')) {\n      navigate('*', { failedHash: hash })\n    } else {\n      console.error(`Unable to navigate to: ${hash}`)\n    }\n    return\n  }\n\n  // update current processed request\n  request.hash = hash\n  request.route = route\n\n  let result = await beforeEachRoute(getActiveHash(), request)\n\n  // test if a local hook is configured for the route\n  if (route.beforeNavigate) {\n    result = await route.beforeNavigate(getActiveHash(), request)\n  }\n\n  if (isBoolean(result)) {\n    // only if resolve value is explicitly true\n    // we continue the current route request\n    if (result) {\n      return resolveHashChange(request)\n    }\n  } else {\n    // if navigation guard didn't return true\n    // we cancel the current request\n    request.cancel()\n    navigateQueue.delete(queueId)\n\n    if (isString(result)) {\n      navigate(result)\n    } else if (isObject(result)) {\n      let store = true\n      if (isBoolean(result.store)) {\n        store = result.store\n      }\n      navigate(result.path, result.params, store)\n    }\n  }\n}\n\n/**\n * Continue processing the hash change if not blocked\n * by global or local hook\n * @param request - {}\n */\nconst resolveHashChange = request => {\n  const hash = request.hash\n  const route = request.route\n  const queueId = decodeURIComponent(hash)\n  // store last requested hash so we can\n  // prevent a route that resolved later\n  // from displaying itself\n  setLastHash(hash)\n\n  if (route.path) {\n    const component = getComponent(route.path)\n    // if a hook is provided for the current route\n    if (isFunction(route.hook)) {\n      const urlParams = getValuesFromHash(hash, route.path)\n      const params = {}\n      for (const key of urlParams.keys()) {\n        params[key] = urlParams.get(key)\n      }\n      route.hook(app, { ...params })\n    }\n    // if there is a component attached to the route\n    if (component) {\n      // force page to root state to prevent shared state issues\n      const activePage = getActivePage()\n      if (activePage) {\n        const keepAlive = keepActivePageAlive(getActiveRoute(), request)\n        if (activePage && route.path === getActiveRoute() && !keepAlive) {\n          activePage._setState('')\n        }\n      }\n\n      if (isPage(component, stage)) {\n        load(request).then(() => {\n          app._refocus()\n          navigateQueue.delete(queueId)\n        })\n      } else {\n        // of the component is not a constructor\n        // or a Component instance we can assume\n        // that it's a dynamic import\n        component()\n          .then(contents => {\n            return contents.default\n          })\n          .then(module => {\n            storeComponent(route.path, module)\n            return load(request)\n          })\n          .then(() => {\n            app._refocus()\n            navigateQueue.delete(queueId)\n          })\n      }\n    } else {\n      navigateQueue.delete(queueId)\n    }\n  }\n}\n\n/**\n * Directional step in history\n * @param direction\n */\nexport const step = (level = 0) => {\n  if (!level || isNaN(level)) {\n    return false\n  }\n  const history = getHistory()\n  // for now we only support negative numbers\n  level = Math.abs(level)\n\n  // we can't step back past the amount\n  // of history entries\n  if (level > history.length) {\n    if (isFunction(app._handleAppClose)) {\n      return app._handleAppClose()\n    }\n    return false\n  } else if (history.length) {\n    // for now we only support history back\n    const route = history.splice(history.length - level, level)[0]\n    // store changed history\n    setHistory(history)\n    return navigate(\n      route.hash,\n      {\n        [symbols.backtrack]: true,\n        [symbols.historyState]: route.state,\n      },\n      false\n    )\n  } else if (routerConfig.get('backtrack')) {\n    const hashLastPart = /(\\/:?[\\w%\\s-]+)$/\n    let hash = stripRegex(getHash())\n    let floor = getFloor(hash)\n\n    // test if we got deep-linked\n    if (floor > 1) {\n      while (floor--) {\n        // strip of last part\n        hash = hash.replace(hashLastPart, '')\n        // if we have a configured route\n        // we navigate to it\n        if (getRouteByHash(hash)) {\n          return navigate(hash, { [symbols.backtrack]: true }, false)\n        }\n      }\n    }\n  }\n  return false\n}\n\n/**\n * Resume Router's page loading process after\n * the BootComponent became visible;\n */\nconst resume = () => {\n  if (isString(resumeHash)) {\n    navigate(resumeHash, false)\n    resumeHash = ''\n  } else if (isFunction(resumeHash)) {\n    resumeHash().then(res => {\n      resumeHash = ''\n      if (isObject(res)) {\n        navigate(res.path, res.params)\n      } else {\n        navigate(res)\n      }\n    })\n  } else {\n    console.warn('[Router]: resume() called but no hash found')\n  }\n}\n\n/**\n * Query if the Router is still processing a Request\n * @returns {boolean}\n */\nconst isNavigating = () => {\n  if (navigateQueue.size) {\n    let isProcessing = false\n    for (let request of navigateQueue.values()) {\n      if (!request.isCancelled) {\n        isProcessing = true\n      }\n    }\n    return isProcessing\n  }\n  return false\n}\n\nexport const getResumeHash = () => {\n  return resumeHash\n}\n\n/**\n * By default we return the location hash\n * @returns {string}\n */\nlet getHash = () => {\n  return document.location.hash\n}\n\n/**\n * Update location hash\n * @param url\n */\nlet setHash = url => {\n  document.location.hash = url\n}\n\n/**\n * This can be called from the platform / bootstrapper to override\n * the default getting and setting of the hash\n * @param config\n */\nexport const initRouter = config => {\n  if (config.getHash) {\n    getHash = config.getHash\n  }\n  if (config.setHash) {\n    setHash = config.setHash\n  }\n}\n\n/**\n * On hash change we start processing\n */\nconst registerListener = () => {\n  Registry.addEventListener(window, 'hashchange', async () => {\n    if (mustUpdateLocationHash()) {\n      try {\n        await handleHashChange()\n      } catch (e) {\n        console.error(e)\n      }\n    }\n  })\n}\n// export API\nexport default {\n  startRouter,\n  navigate,\n  resume,\n  step,\n  go: step,\n  back: step.bind(null, -1),\n  activePage: getActivePage,\n  getActivePage() {\n    // warning\n    return getActivePage()\n  },\n  getActiveRoute,\n  getActiveHash,\n  focusWidget,\n  getActiveWidget,\n  restoreFocus,\n  isNavigating,\n  getHistory,\n  setHistory,\n  getHistoryState,\n  replaceHistoryState,\n  getQueryStringParams,\n  symbols,\n  App: RoutedApp,\n  // keep backwards compatible\n  focusPage: restoreFocus,\n  /**\n   * Deprecated api methods\n   */\n  setupRoutes() {\n    console.warn('Router: setupRoutes is deprecated, consolidate your configuration')\n    console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration')\n  },\n  on() {\n    console.warn('Router.on() is deprecated, consolidate your configuration')\n    console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration')\n  },\n  before() {\n    console.warn('Router.before() is deprecated, consolidate your configuration')\n    console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration')\n  },\n  after() {\n    console.warn('Router.after() is deprecated, consolidate your configuration')\n    console.warn('https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration')\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings'\n\nconst defaultChannels = [\n  {\n    number: 1,\n    name: 'Metro News 1',\n    description: 'New York Cable News Channel',\n    entitled: true,\n    program: {\n      title: 'The Morning Show',\n      description: \"New York's best morning show\",\n      startTime: new Date(new Date() - 60 * 5 * 1000).toUTCString(), // started 5 minutes ago\n      duration: 60 * 30, // 30 minutes\n      ageRating: 0,\n    },\n  },\n  {\n    number: 2,\n    name: 'MTV',\n    description: 'Music Television',\n    entitled: true,\n    program: {\n      title: 'Beavis and Butthead',\n      description: 'American adult animated sitcom created by Mike Judge',\n      startTime: new Date(new Date() - 60 * 20 * 1000).toUTCString(), // started 20 minutes ago\n      duration: 60 * 45, // 45 minutes\n      ageRating: 18,\n    },\n  },\n  {\n    number: 3,\n    name: 'NBC',\n    description: 'NBC TV Network',\n    entitled: false,\n    program: {\n      title: 'The Tonight Show Starring Jimmy Fallon',\n      description: 'Late-night talk show hosted by Jimmy Fallon on NBC',\n      startTime: new Date(new Date() - 60 * 10 * 1000).toUTCString(), // started 10 minutes ago\n      duration: 60 * 60, // 1 hour\n      ageRating: 10,\n    },\n  },\n]\n\nexport const channels = () => Settings.get('platform', 'tv', defaultChannels)\n\nexport const randomChannel = () => channels()[~~(channels.length * Math.random())]\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../Log'\n\nimport { channels, randomChannel } from './defaults'\n\nlet currentChannel\nconst callbacks = {}\n\nconst emit = (event, ...args) => {\n  callbacks[event] &&\n    callbacks[event].forEach(cb => {\n      cb.apply(null, args)\n    })\n}\n\n// local mock methods\nlet methods = {\n  getChannel() {\n    if (!currentChannel) currentChannel = randomChannel()\n    return new Promise((resolve, reject) => {\n      if (currentChannel) {\n        const channel = { ...currentChannel }\n        delete channel.program\n        resolve(channel)\n      } else {\n        reject('No channel found')\n      }\n    })\n  },\n  getProgram() {\n    if (!currentChannel) currentChannel = randomChannel()\n    return new Promise((resolve, reject) => {\n      currentChannel.program ? resolve(currentChannel.program) : reject('No program found')\n    })\n  },\n  setChannel(number) {\n    return new Promise((resolve, reject) => {\n      if (number) {\n        const newChannel = channels().find(c => c.number === number)\n        if (newChannel) {\n          currentChannel = newChannel\n          const channel = { ...currentChannel }\n          delete channel.program\n          emit('channelChange', channel)\n          resolve(channel)\n        } else {\n          reject('Channel not found')\n        }\n      } else {\n        reject('No channel number supplied')\n      }\n    })\n  },\n}\n\nexport const initTV = config => {\n  methods = {}\n  if (config.getChannel && typeof config.getChannel === 'function') {\n    methods.getChannel = config.getChannel\n  }\n  if (config.getProgram && typeof config.getProgram === 'function') {\n    methods.getProgram = config.getProgram\n  }\n  if (config.setChannel && typeof config.setChannel === 'function') {\n    methods.setChannel = config.setChannel\n  }\n  if (config.emit && typeof config.emit === 'function') {\n    config.emit(emit)\n  }\n}\n\n// public API\nexport default {\n  channel(number = null) {\n    return new Promise((resolve, reject) => {\n      try {\n        // call setChannel when number argument is passed, otherwise getChannel\n        methods[number ? 'setChannel' : 'getChannel'](number)\n          .then(channel => {\n            // to do: ensure consistent formatting of channel info here?\n            resolve(channel)\n          })\n          .catch(reject)\n      } catch (e) {\n        reject(e)\n      }\n    })\n  },\n  program() {\n    return new Promise((resolve, reject) => {\n      try {\n        methods\n          .getProgram()\n          .then(program => {\n            // to do: ensure consistent formatting of program info here?\n            resolve(program)\n          })\n          .catch(reject)\n      } catch (e) {\n        reject(e)\n      }\n    })\n  },\n  entitled() {\n    return new Promise((resolve, reject) => {\n      try {\n        methods\n          .getChannel()\n          .then(channel => {\n            'entitled' in channel ? resolve(!!channel.entitled) : reject()\n          })\n          .catch(reject)\n      } catch (e) {\n        reject(e)\n      }\n    })\n  },\n  addEventListener(event, cb) {\n    if (typeof cb === 'function') {\n      callbacks[event] = callbacks[event] || []\n      callbacks[event].push(cb)\n    } else {\n      Log.error('Please provide a function as a callback')\n    }\n  },\n  removeEventListener(event, cb = false) {\n    if (callbacks[event] && callbacks[event].length) {\n      callbacks[event] = cb ? callbacks[event].filter(_cb => _cb === cb) : []\n    }\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Profile from '../Profile'\nimport Settings from '../Settings'\nimport sequence from '../helpers/sequence'\n\nlet cspUrl = 'http://payment-csp-example.metrological.com:8080/'\nlet billingUrl = 'https://payment-sdk.metrological.com/'\n\nlet cspEndpoints = {\n  assets: {\n    uri: '/assets',\n    method: 'GET',\n  },\n  asset: {\n    uri: '/assets/:id',\n    method: 'GET',\n  },\n  signature: {\n    uri: '/assets/:id/signature',\n    method: 'POST',\n  },\n  subscribe: {\n    uri: '/assets/:id/subscribe',\n    method: 'POST',\n  },\n  unsubscribe: {\n    uri: '/assets/:id/unsubscribe',\n    method: 'POST',\n  },\n}\n\nexport const initPurchase = config => {\n  if (config.billingUrl) billingUrl = config.billingUrl\n}\n\nconst createUrl = (uri, baseUrl, params = {}) => {\n  return new URL(\n    // sprinkle in the params\n    Object.keys(params)\n      .reduce((res, key) => res.replace(new RegExp(':' + key, 'g'), params[key]), uri)\n      // remove any leading slash from uri\n      .replace(/^\\//, ''),\n    // make sure baseUrl always has a trailing slash\n    /\\/$/.test(baseUrl) ? baseUrl : baseUrl.replace(/$/, '/')\n  )\n}\n\nconst request = (url, method = 'GET', data, headers = {}) => {\n  if (method === 'GET' && data) {\n    url.search = new URLSearchParams(data)\n  }\n\n  return new Promise((resolve, reject) => {\n    fetch(url, {\n      headers: {\n        ...{\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n        },\n        ...headers,\n      },\n      method: method,\n      body: method !== 'GET' && data ? JSON.stringify(data) : null,\n    })\n      .then(response => (response.ok ? resolve(response.json()) : reject(response.statusText)))\n      .catch(reject)\n  })\n}\n\nconst cspRequest = (type, data = null, params = {}) => {\n  return new Promise((resolve, reject) => {\n    const endpoint = cspEndpoints[type]\n\n    if (!endpoint) {\n      reject('No endpoint found for \"' + type + '\" call')\n    } else {\n      if (endpoint.callback && typeof endpoint.callback === 'function') {\n        endpoint\n          .callback(data, params)\n          .then(resolve)\n          .catch(reject)\n      } else {\n        request(\n          createUrl(endpoint.uri, cspUrl, params),\n          endpoint.method,\n          {\n            ...(endpoint.data || {}),\n            ...data,\n          },\n          endpoint.headers || {}\n        )\n          .then(resolve)\n          .catch(reject)\n      }\n    }\n  })\n}\n\nconst billingRequest = (uri, data, method = 'POST') => {\n  return new Promise((resolve, reject) => {\n    request(createUrl(uri, billingUrl), method, data)\n      .then(resolve)\n      .catch(reject)\n  })\n}\n\nexport default {\n  setup(config) {\n    if (config.cspUrl) cspUrl = config.cspUrl\n    if (config.endpoints) cspEndpoints = { cspEndpoints, ...config.endpoints }\n  },\n  assets() {\n    return new Promise((resolve, reject) => {\n      Profile.household().then(household => {\n        cspRequest('assets', { household })\n          .then(resolve)\n          .catch(reject)\n      })\n    })\n  },\n  asset(id) {\n    return new Promise((resolve, reject) => {\n      Profile.household().then(household => {\n        cspRequest('asset', { household }, { id })\n          .then(resolve)\n          .catch(reject)\n      })\n    })\n  },\n  signature(id) {\n    return new Promise((resolve, reject) => {\n      Promise.all([Profile.household()]).then(([household]) => {\n        cspRequest('signature', { household }, { id })\n          .then(resolve)\n          .catch(reject)\n      })\n    })\n  },\n  subscribe(id, transaction) {\n    return new Promise((resolve, reject) => {\n      cspRequest('subscribe', { ...transaction }, { id })\n        .then(resolve)\n        .catch(reject)\n    })\n  },\n  unsubscribe(id) {\n    return new Promise((resolve, reject) => {\n      Profile.household().then(household => {\n        cspRequest('unsubscribe', { household }, { id })\n          .then(resolve)\n          .catch(reject)\n      })\n    })\n  },\n  payment(signature = {}, type = 'in-app') {\n    return new Promise((resolve, reject) => {\n      Promise.all([\n        Profile.household(),\n        Profile.countryCode(),\n        Profile.operator(),\n        Profile.mac(),\n        Profile.uid(),\n      ])\n        .then(([household, country, operator, mac, uid]) => {\n          billingRequest('/', {\n            purchase: signature,\n            identifier: Settings.get('app', 'id'),\n            name: Settings.get('app', 'id'),\n            household,\n            country,\n            operator,\n            mac,\n            uid,\n            type,\n          })\n            .then(resolve)\n            .catch(reject)\n        })\n        .catch(reject)\n    })\n  },\n  confirm(transactionId) {\n    return new Promise((resolve, reject) => {\n      billingRequest('/confirm', {\n        transactionId,\n      })\n        .then(resolve)\n        .catch(reject)\n    })\n  },\n  buy(assetId, type) {\n    return new Promise((resolve, reject) => {\n      let transactionId\n      sequence([\n        () => this.signature(assetId),\n        signature => this.payment(signature, type),\n        transaction => {\n          transactionId = transaction.transactionId\n          return this.subscribe(assetId, transaction)\n        },\n        () => this.confirm(transactionId),\n      ])\n        .then(resolve)\n        .catch(reject)\n    })\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../Lightning'\nimport Pin from '../Pin'\n\nclass PinInput extends Lightning.Component {\n  static _template() {\n    return {\n      w: 120,\n      h: 150,\n      rect: true,\n      color: 0xff949393,\n      alpha: 0.5,\n      shader: { type: Lightning.shaders.RoundedRectangle, radius: 10 },\n      Nr: {\n        w: w => w,\n        y: 24,\n        text: {\n          text: '',\n          textColor: 0xff333333,\n          fontSize: 80,\n          textAlign: 'center',\n          verticalAlign: 'middle',\n        },\n      },\n    }\n  }\n\n  set index(v) {\n    this.x = v * (120 + 24)\n  }\n\n  set nr(v) {\n    this._timeout && clearTimeout(this._timeout)\n\n    if (v) {\n      this.setSmooth('alpha', 1)\n    } else {\n      this.setSmooth('alpha', 0.5)\n    }\n\n    this.tag('Nr').patch({\n      text: {\n        text: (v && v.toString()) || '',\n        fontSize: v === '*' ? 120 : 80,\n      },\n    })\n\n    if (v && v !== '*') {\n      this._timeout = setTimeout(() => {\n        this._timeout = null\n        this.nr = '*'\n      }, 750)\n    }\n  }\n}\n\nexport default class PinDialog extends Lightning.Component {\n  static _template() {\n    return {\n      zIndex: 1,\n      w: w => w,\n      h: h => h,\n      rect: true,\n      color: 0xdd000000,\n      alpha: 0.000001,\n      Dialog: {\n        w: 648,\n        h: 320,\n        y: h => (h - 320) / 2,\n        x: w => (w - 648) / 2,\n        rect: true,\n        color: 0xdd333333,\n        shader: { type: Lightning.shaders.RoundedRectangle, radius: 10 },\n        Info: {\n          y: 24,\n          x: 48,\n          text: { text: 'Please enter your PIN', fontSize: 32 },\n        },\n        Msg: {\n          y: 260,\n          x: 48,\n          text: { text: '', fontSize: 28, textColor: 0xffffffff },\n        },\n        Code: {\n          x: 48,\n          y: 96,\n        },\n      },\n    }\n  }\n\n  _init() {\n    const children = []\n    for (let i = 0; i < 4; i++) {\n      children.push({\n        type: PinInput,\n        index: i,\n      })\n    }\n\n    this.tag('Code').children = children\n  }\n\n  get pin() {\n    if (!this._pin) this._pin = ''\n    return this._pin\n  }\n\n  set pin(v) {\n    if (v.length <= 4) {\n      const maskedPin = new Array(Math.max(v.length - 1, 0)).fill('*', 0, v.length - 1)\n      v.length && maskedPin.push(v.length > this._pin.length ? v.slice(-1) : '*')\n      for (let i = 0; i < 4; i++) {\n        this.tag('Code').children[i].nr = maskedPin[i] || ''\n      }\n      this._pin = v\n    }\n  }\n\n  get msg() {\n    if (!this._msg) this._msg = ''\n    return this._msg\n  }\n\n  set msg(v) {\n    this._timeout && clearTimeout(this._timeout)\n\n    this._msg = v\n    if (this._msg) {\n      this.tag('Msg').text = this._msg\n      this.tag('Info').setSmooth('alpha', 0.5)\n      this.tag('Code').setSmooth('alpha', 0.5)\n    } else {\n      this.tag('Msg').text = ''\n      this.tag('Info').setSmooth('alpha', 1)\n      this.tag('Code').setSmooth('alpha', 1)\n    }\n    this._timeout = setTimeout(() => {\n      this.msg = ''\n    }, 2000)\n  }\n\n  _firstActive() {\n    this.setSmooth('alpha', 1)\n  }\n\n  _handleKey(event) {\n    if (this.msg) {\n      this.msg = false\n    } else {\n      const val = parseInt(event.key)\n      if (val > -1) {\n        this.pin += val\n      }\n    }\n  }\n\n  _handleBack() {\n    if (this.msg) {\n      this.msg = false\n    } else {\n      if (this.pin.length) {\n        this.pin = this.pin.slice(0, this.pin.length - 1)\n      } else {\n        Pin.hide()\n        this.resolve(false)\n      }\n    }\n  }\n\n  _handleEnter() {\n    if (this.msg) {\n      this.msg = false\n    } else {\n      Pin.submit(this.pin)\n        .then(val => {\n          this.msg = 'Unlocking ...'\n          setTimeout(() => {\n            Pin.hide()\n          }, 1000)\n          this.resolve(val)\n        })\n        .catch(e => {\n          this.msg = e\n          this.reject(e)\n        })\n    }\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings'\nimport PinDialog from './dialog'\nimport { ApplicationInstance } from '../Launch'\nimport { Log } from '../../index'\n\n// only used during local development\nlet unlocked = false\nconst contextItems = ['purchase', 'parental']\n\nlet submit = (pin, context) => {\n  return new Promise((resolve, reject) => {\n    if (pin.toString() === Settings.get('platform', 'pin', '0000').toString()) {\n      unlocked = true\n      resolve(unlocked)\n    } else {\n      reject('Incorrect pin')\n    }\n  })\n}\n\nlet check = context => {\n  return new Promise(resolve => {\n    resolve(unlocked)\n  })\n}\n\nexport const initPin = config => {\n  if (config.submit && typeof config.submit === 'function') {\n    submit = config.submit\n  }\n  if (config.check && typeof config.check === 'function') {\n    check = config.check\n  }\n}\n\nlet pinDialog = null\n\nconst contextCheck = context => {\n  if (context === undefined) {\n    Log.info('Please provide context explicitly')\n    return contextItems[0]\n  } else if (!contextItems.includes(context)) {\n    Log.warn('Incorrect context provided')\n    return false\n  }\n  return context\n}\n\n// Public API\nexport default {\n  show() {\n    return new Promise((resolve, reject) => {\n      pinDialog = ApplicationInstance.stage.c({\n        ref: 'PinDialog',\n        type: PinDialog,\n        resolve,\n        reject,\n      })\n      ApplicationInstance.childList.a(pinDialog)\n      ApplicationInstance.focus = pinDialog\n    })\n  },\n  hide() {\n    ApplicationInstance.focus = null\n    ApplicationInstance.children = ApplicationInstance.children.map(\n      child => child !== pinDialog && child\n    )\n    pinDialog = null\n  },\n  submit(pin, context) {\n    return new Promise((resolve, reject) => {\n      try {\n        context = contextCheck(context)\n        if (context) {\n          submit(pin, context)\n            .then(resolve)\n            .catch(reject)\n        } else {\n          reject('Incorrect Context provided')\n        }\n      } catch (e) {\n        reject(e)\n      }\n    })\n  },\n  unlocked(context) {\n    return new Promise((resolve, reject) => {\n      try {\n        context = contextCheck(context)\n        if (context) {\n          check(context)\n            .then(resolve)\n            .catch(reject)\n        } else {\n          reject('Incorrect Context provided')\n        }\n      } catch (e) {\n        reject(e)\n      }\n    })\n  },\n  locked(context) {\n    return new Promise((resolve, reject) => {\n      try {\n        context = contextCheck(context)\n        if (context) {\n          check(context)\n            .then(unlocked => resolve(!!!unlocked))\n            .catch(reject)\n        } else {\n          reject('Incorrect Context provided')\n        }\n      } catch (e) {\n        reject(e)\n      }\n    })\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { initUtils } from '../Utils'\nimport { initProfile } from '../Profile'\nimport { initMetrics } from '../Metrics'\nimport { initSettings } from '../Settings'\nimport { initMediaPlayer } from '../MediaPlayer'\nimport { initVideoPlayer } from '../VideoPlayer'\nimport { initStorage } from '../Storage'\nimport { initAds } from '../Ads'\nimport { initRouter } from '../Router'\nimport { initTV } from '../TV'\nimport { initPurchase } from '../Purchase'\nimport { initPin } from '../Pin'\nimport { initMetadata } from '../Metadata'\nimport Application from '../Application'\n\nexport let ApplicationInstance\n\nexport default (App, appSettings, platformSettings, appData) => {\n  initSettings(appSettings, platformSettings)\n  initMetadata(appSettings)\n\n  initUtils(platformSettings)\n  initStorage()\n  // Initialize plugins\n  if (platformSettings.plugins) {\n    platformSettings.plugins.profile && initProfile(platformSettings.plugins.profile)\n    platformSettings.plugins.metrics && initMetrics(platformSettings.plugins.metrics)\n    platformSettings.plugins.mediaPlayer && initMediaPlayer(platformSettings.plugins.mediaPlayer)\n    platformSettings.plugins.mediaPlayer && initVideoPlayer(platformSettings.plugins.mediaPlayer)\n    platformSettings.plugins.ads && initAds(platformSettings.plugins.ads)\n    platformSettings.plugins.router && initRouter(platformSettings.plugins.router)\n    platformSettings.plugins.tv && initTV(platformSettings.plugins.tv)\n    platformSettings.plugins.purchase && initPurchase(platformSettings.plugins.purchase)\n    platformSettings.plugins.pin && initPin(platformSettings.plugins.pin)\n  }\n\n  const app = Application(App, appData, platformSettings)\n  ApplicationInstance = new app(appSettings)\n  return ApplicationInstance\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../Lightning'\nimport Log from '../Log'\n\nexport default class VideoTexture extends Lightning.Component {\n  static _template() {\n    return {\n      Video: {\n        alpha: 1,\n        visible: false,\n        pivot: 0.5,\n        texture: { type: Lightning.textures.StaticTexture, options: {} },\n      },\n    }\n  }\n\n  set videoEl(v) {\n    this._videoEl = v\n  }\n\n  get videoEl() {\n    return this._videoEl\n  }\n\n  get videoView() {\n    return this.tag('Video')\n  }\n\n  get videoTexture() {\n    return this.videoView.texture\n  }\n\n  get isVisible() {\n    return this.videoView.alpha === 1 && this.videoView.visible === true\n  }\n\n  _init() {\n    this._createVideoTexture()\n  }\n\n  _createVideoTexture() {\n    const stage = this.stage\n\n    const gl = stage.gl\n    const glTexture = gl.createTexture()\n    gl.bindTexture(gl.TEXTURE_2D, glTexture)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n    this.videoTexture.options = { source: glTexture, w: this.videoEl.width, h: this.videoEl.height }\n\n    this.videoView.w = this.videoEl.width / this.stage.getRenderPrecision()\n    this.videoView.h = this.videoEl.height / this.stage.getRenderPrecision()\n  }\n\n  start() {\n    const stage = this.stage\n    this._lastTime = 0\n    if (!this._updateVideoTexture) {\n      this._updateVideoTexture = () => {\n        if (this.videoTexture.options.source && this.videoEl.videoWidth && this.active) {\n          const gl = stage.gl\n\n          const currentTime = new Date().getTime()\n          const getVideoPlaybackQuality = this.videoEl.getVideoPlaybackQuality()\n\n          // When BR2_PACKAGE_GST1_PLUGINS_BAD_PLUGIN_DEBUGUTILS is not set in WPE, webkitDecodedFrameCount will not be available.\n          // We'll fallback to fixed 30fps in this case.\n          // As 'webkitDecodedFrameCount' is about to deprecate, check for the 'totalVideoFrames'\n          const frameCount = getVideoPlaybackQuality\n            ? getVideoPlaybackQuality.totalVideoFrames\n            : this.videoEl.webkitDecodedFrameCount\n\n          const mustUpdate = frameCount\n            ? this._lastFrame !== frameCount\n            : this._lastTime < currentTime - 30\n\n          if (mustUpdate) {\n            this._lastTime = currentTime\n            this._lastFrame = frameCount\n            try {\n              gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source)\n              gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false)\n              gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.videoEl)\n              this._lastFrame = this.videoEl.webkitDecodedFrameCount\n              this.videoView.visible = true\n\n              this.videoTexture.options.w = this.videoEl.width\n              this.videoTexture.options.h = this.videoEl.height\n              const expectedAspectRatio = this.videoView.w / this.videoView.h\n              const realAspectRatio = this.videoEl.width / this.videoEl.height\n\n              if (expectedAspectRatio > realAspectRatio) {\n                this.videoView.scaleX = realAspectRatio / expectedAspectRatio\n                this.videoView.scaleY = 1\n              } else {\n                this.videoView.scaleY = expectedAspectRatio / realAspectRatio\n                this.videoView.scaleX = 1\n              }\n            } catch (e) {\n              Log.error('texImage2d video', e)\n              this.stop()\n            }\n            this.videoTexture.source.forceRenderUpdate()\n          }\n        }\n      }\n    }\n    if (!this._updatingVideoTexture) {\n      stage.on('frameStart', this._updateVideoTexture)\n      this._updatingVideoTexture = true\n    }\n  }\n\n  stop() {\n    const stage = this.stage\n    stage.removeListener('frameStart', this._updateVideoTexture)\n    this._updatingVideoTexture = false\n    this.videoView.visible = false\n\n    if (this.videoTexture.options.source) {\n      const gl = stage.gl\n      gl.bindTexture(gl.TEXTURE_2D, this.videoTexture.options.source)\n      gl.clearColor(0, 0, 0, 1)\n      gl.clear(gl.COLOR_BUFFER_BIT)\n    }\n  }\n\n  position(top, left) {\n    this.videoView.patch({\n      smooth: {\n        x: left,\n        y: top,\n      },\n    })\n  }\n\n  size(width, height) {\n    this.videoView.patch({\n      smooth: {\n        w: width,\n        h: height,\n      },\n    })\n  }\n\n  show() {\n    this.videoView.setSmooth('alpha', 1)\n  }\n\n  hide() {\n    this.videoView.setSmooth('alpha', 0)\n  }\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport executeAsPromise from '@michieljs/execute-as-promise'\n\nimport Metrics from '../Metrics'\nimport Log from '../Log'\nimport Ads from '../Ads'\n\nimport events from './events'\nimport autoSetupMixin from '../helpers/autoSetupMixin'\nimport easeExecution from '../helpers/easeExecution'\nimport { ApplicationInstance } from '../Launch'\nimport Settings from '../Settings'\nimport VideoTexture from './VideoTexture'\n\nexport let mediaUrl = url => url\nlet videoEl\nlet videoTexture\nlet metrics\nlet consumer\nlet precision = 1\nlet textureMode = false\n\nexport const initVideoPlayer = config => {\n  if (config.mediaUrl) {\n    mediaUrl = config.mediaUrl\n  }\n}\n\n// todo: add this in a 'Registry' plugin\n// to be able to always clean this up on app close\nlet eventHandlers = {}\n\nconst state = {\n  adsEnabled: false,\n  playing: false,\n  _playingAds: false,\n  get playingAds() {\n    return this._playingAds\n  },\n  set playingAds(val) {\n    if (this._playingAds !== val) {\n      this._playingAds = val\n      fireOnConsumer(val === true ? 'AdStart' : 'AdEnd')\n    }\n  },\n  skipTime: false,\n  playAfterSeek: null,\n}\n\nconst hooks = {\n  play() {\n    state.playing = true\n  },\n  pause() {\n    state.playing = false\n  },\n  seeked() {\n    state.playAfterSeek === true && videoPlayerPlugin.play()\n    state.playAfterSeek = null\n  },\n  abort() {\n    deregisterEventListeners()\n  },\n}\n\nconst withPrecision = val => Math.round(precision * val) + 'px'\n\nconst fireOnConsumer = (event, args) => {\n  if (consumer) {\n    consumer.fire('$videoPlayer' + event, args, videoEl.currentTime)\n    consumer.fire('$videoPlayerEvent', event, args, videoEl.currentTime)\n  }\n}\n\nconst fireHook = (event, args) => {\n  hooks[event] && typeof hooks[event] === 'function' && hooks[event].call(null, event, args)\n}\n\nlet customLoader = null\nlet customUnloader = null\n\nconst loader = (url, videoEl, config) => {\n  return customLoader && typeof customLoader === 'function'\n    ? customLoader(url, videoEl, config)\n    : new Promise(resolve => {\n        url = mediaUrl(url)\n        videoEl.setAttribute('src', url)\n        videoEl.load()\n        resolve()\n      })\n}\n\nconst unloader = videoEl => {\n  return customUnloader && typeof customUnloader === 'function'\n    ? customUnloader(videoEl)\n    : new Promise(resolve => {\n        videoEl.removeAttribute('src')\n        videoEl.load()\n        resolve()\n      })\n}\n\nexport const setupVideoTag = () => {\n  const videoEls = document.getElementsByTagName('video')\n  if (videoEls && videoEls.length) {\n    return videoEls[0]\n  } else {\n    const videoEl = document.createElement('video')\n    videoEl.setAttribute('id', 'video-player')\n    videoEl.setAttribute('width', withPrecision(1920))\n    videoEl.setAttribute('height', withPrecision(1080))\n    videoEl.style.position = 'absolute'\n    videoEl.style.zIndex = '1'\n    videoEl.style.display = 'none'\n    videoEl.style.visibility = 'hidden'\n    videoEl.style.top = withPrecision(0)\n    videoEl.style.left = withPrecision(0)\n    videoEl.style.width = withPrecision(1920)\n    videoEl.style.height = withPrecision(1080)\n    document.body.appendChild(videoEl)\n    return videoEl\n  }\n}\n\nexport const setUpVideoTexture = () => {\n  if (!ApplicationInstance.tag('VideoTexture')) {\n    const el = ApplicationInstance.stage.c({\n      type: VideoTexture,\n      ref: 'VideoTexture',\n      zIndex: 0,\n      videoEl,\n    })\n    ApplicationInstance.childList.addAt(el, 0)\n  }\n  return ApplicationInstance.tag('VideoTexture')\n}\n\nconst registerEventListeners = () => {\n  Log.info('VideoPlayer', 'Registering event listeners')\n  Object.keys(events).forEach(event => {\n    const handler = e => {\n      // Fire a metric for each event (if it exists on the metrics object)\n      if (metrics && metrics[event] && typeof metrics[event] === 'function') {\n        metrics[event]({ currentTime: videoEl.currentTime })\n      }\n      // fire an internal hook\n      fireHook(event, { videoElement: videoEl, event: e })\n\n      // fire the event (with human friendly event name) to the consumer of the VideoPlayer\n      fireOnConsumer(events[event], { videoElement: videoEl, event: e })\n    }\n\n    eventHandlers[event] = handler\n    videoEl.addEventListener(event, handler)\n  })\n}\n\nconst deregisterEventListeners = () => {\n  Log.info('VideoPlayer', 'Deregistering event listeners')\n  Object.keys(eventHandlers).forEach(event => {\n    videoEl.removeEventListener(event, eventHandlers[event])\n  })\n  eventHandlers = {}\n}\n\nconst videoPlayerPlugin = {\n  consumer(component) {\n    consumer = component\n  },\n\n  loader(loaderFn) {\n    customLoader = loaderFn\n  },\n\n  unloader(unloaderFn) {\n    customUnloader = unloaderFn\n  },\n\n  position(top = 0, left = 0) {\n    videoEl.style.left = withPrecision(left)\n    videoEl.style.top = withPrecision(top)\n    if (textureMode === true) {\n      videoTexture.position(top, left)\n    }\n  },\n\n  size(width = 1920, height = 1080) {\n    videoEl.style.width = withPrecision(width)\n    videoEl.style.height = withPrecision(height)\n    videoEl.width = parseFloat(videoEl.style.width)\n    videoEl.height = parseFloat(videoEl.style.height)\n    if (textureMode === true) {\n      videoTexture.size(width, height)\n    }\n  },\n\n  area(top = 0, right = 1920, bottom = 1080, left = 0) {\n    this.position(top, left)\n    this.size(right - left, bottom - top)\n  },\n\n  open(url, config = {}) {\n    if (!this.canInteract) return\n    metrics = Metrics.media(url)\n\n    this.hide()\n    deregisterEventListeners()\n\n    if (this.src == url) {\n      this.clear().then(this.open(url, config))\n    } else {\n      const adConfig = { enabled: state.adsEnabled, duration: 300 }\n      if (config.videoId) {\n        adConfig.caid = config.videoId\n      }\n      Ads.get(adConfig, consumer).then(ads => {\n        state.playingAds = true\n        ads.prerolls().then(() => {\n          state.playingAds = false\n          loader(url, videoEl, config)\n            .then(() => {\n              registerEventListeners()\n              this.show()\n              this.play()\n            })\n            .catch(e => {\n              fireOnConsumer('error', { videoElement: videoEl, event: e })\n            })\n        })\n      })\n    }\n  },\n\n  reload() {\n    if (!this.canInteract) return\n    const url = videoEl.getAttribute('src')\n    this.close()\n    this.open(url)\n  },\n\n  close() {\n    Ads.cancel()\n    if (state.playingAds) {\n      state.playingAds = false\n      Ads.stop()\n      // call self in next tick\n      setTimeout(() => {\n        this.close()\n      })\n    }\n    if (!this.canInteract) return\n    this.clear()\n    this.hide()\n    deregisterEventListeners()\n  },\n\n  clear() {\n    if (!this.canInteract) return\n    // pause the video first to disable sound\n    this.pause()\n    if (textureMode === true) videoTexture.stop()\n    return unloader(videoEl).then(() => {\n      fireOnConsumer('Clear', { videoElement: videoEl })\n    })\n  },\n\n  play() {\n    if (!this.canInteract) return\n    if (textureMode === true) videoTexture.start()\n    executeAsPromise(videoEl.play, null, videoEl).catch(e => {\n      fireOnConsumer('error', { videoElement: videoEl, event: e })\n    })\n  },\n\n  pause() {\n    if (!this.canInteract) return\n    videoEl.pause()\n  },\n\n  playPause() {\n    if (!this.canInteract) return\n    this.playing === true ? this.pause() : this.play()\n  },\n\n  mute(muted = true) {\n    if (!this.canInteract) return\n    videoEl.muted = muted\n  },\n\n  loop(looped = true) {\n    videoEl.loop = looped\n  },\n\n  seek(time) {\n    if (!this.canInteract) return\n    if (!this.src) return\n    // define whether should continue to play after seek is complete (in seeked hook)\n    if (state.playAfterSeek === null) {\n      state.playAfterSeek = !!state.playing\n    }\n    // pause before actually seeking\n    this.pause()\n    // currentTime always between 0 and the duration of the video (minus 0.1s to not set to the final frame and stall the video)\n    videoEl.currentTime = Math.max(0, Math.min(time, this.duration - 0.1))\n  },\n\n  skip(seconds) {\n    if (!this.canInteract) return\n    if (!this.src) return\n\n    state.skipTime = (state.skipTime || videoEl.currentTime) + seconds\n    easeExecution(() => {\n      this.seek(state.skipTime)\n      state.skipTime = false\n    }, 300)\n  },\n\n  show() {\n    if (!this.canInteract) return\n    if (textureMode === true) {\n      videoTexture.show()\n    } else {\n      videoEl.style.display = 'block'\n      videoEl.style.visibility = 'visible'\n    }\n  },\n\n  hide() {\n    if (!this.canInteract) return\n    if (textureMode === true) {\n      videoTexture.hide()\n    } else {\n      videoEl.style.display = 'none'\n      videoEl.style.visibility = 'hidden'\n    }\n  },\n\n  enableAds(enabled = true) {\n    state.adsEnabled = enabled\n  },\n\n  /* Public getters */\n  get duration() {\n    return videoEl && (isNaN(videoEl.duration) ? Infinity : videoEl.duration)\n  },\n\n  get currentTime() {\n    return videoEl && videoEl.currentTime\n  },\n\n  get muted() {\n    return videoEl && videoEl.muted\n  },\n\n  get looped() {\n    return videoEl && videoEl.loop\n  },\n\n  get src() {\n    return videoEl && videoEl.getAttribute('src')\n  },\n\n  get playing() {\n    return state.playing\n  },\n\n  get playingAds() {\n    return state.playingAds\n  },\n\n  get canInteract() {\n    // todo: perhaps add an extra flag wether we allow interactions (i.e. pauze, mute, etc.) during ad playback\n    return state.playingAds === false\n  },\n\n  get top() {\n    return videoEl && parseFloat(videoEl.style.top)\n  },\n\n  get left() {\n    return videoEl && parseFloat(videoEl.style.left)\n  },\n\n  get bottom() {\n    return videoEl && parseFloat(videoEl.style.top - videoEl.style.height)\n  },\n\n  get right() {\n    return videoEl && parseFloat(videoEl.style.left - videoEl.style.width)\n  },\n\n  get width() {\n    return videoEl && parseFloat(videoEl.style.width)\n  },\n\n  get height() {\n    return videoEl && parseFloat(videoEl.style.height)\n  },\n\n  get visible() {\n    if (textureMode === true) {\n      return videoTexture.isVisible\n    } else {\n      return videoEl && videoEl.style.display === 'block'\n    }\n  },\n\n  get adsEnabled() {\n    return state.adsEnabled\n  },\n\n  // prefixed with underscore to indicate 'semi-private'\n  // because it's not recommended to interact directly with the video element\n  get _videoEl() {\n    return videoEl\n  },\n\n  get _consumer() {\n    return consumer\n  },\n}\n\nexport default autoSetupMixin(videoPlayerPlugin, () => {\n  precision =\n    (ApplicationInstance &&\n      ApplicationInstance.stage &&\n      ApplicationInstance.stage.getRenderPrecision()) ||\n    precision\n\n  videoEl = setupVideoTag()\n\n  textureMode = Settings.get('platform', 'textureMode', false)\n  if (textureMode === true) {\n    videoEl.setAttribute('crossorigin', 'anonymous')\n    videoTexture = setUpVideoTexture()\n  }\n})\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../Log'\nimport { mediaUrl } from '../VideoPlayer'\n\nlet consumer\n\nlet getAds = () => {\n  // todo: enable some default ads during development, maybe from the settings.json\n  return Promise.resolve({\n    prerolls: [],\n    midrolls: [],\n    postrolls: [],\n  })\n}\n\nexport const initAds = config => {\n  if (config.getAds) {\n    getAds = config.getAds\n  }\n}\n\nconst state = {\n  active: false,\n}\n\nconst playSlot = (slot = []) => {\n  return slot.reduce((promise, ad) => {\n    return promise.then(() => {\n      return playAd(ad)\n    })\n  }, Promise.resolve(null))\n}\n\nconst playAd = ad => {\n  return new Promise(resolve => {\n    if (state.active === false) {\n      Log.info('Ad', 'Skipping add due to inactive state')\n      return resolve()\n    }\n    // is it safe to rely on videoplayer plugin already created the video tag?\n    const videoEl = document.getElementsByTagName('video')[0]\n    videoEl.style.display = 'block'\n    videoEl.style.visibility = 'visible'\n    videoEl.src = mediaUrl(ad.url)\n    videoEl.load()\n\n    let timeEvents = null\n    let timeout\n\n    const cleanup = () => {\n      // remove all listeners\n      Object.keys(handlers).forEach(handler =>\n        videoEl.removeEventListener(handler, handlers[handler])\n      )\n      resolve()\n    }\n    const handlers = {\n      play() {\n        Log.info('Ad', 'Play ad', ad.url)\n        fireOnConsumer('Play', ad)\n        sendBeacon(ad.callbacks, 'defaultImpression')\n      },\n      ended() {\n        fireOnConsumer('Ended', ad)\n        sendBeacon(ad.callbacks, 'complete')\n        cleanup()\n      },\n      timeupdate() {\n        if (!timeEvents && videoEl.duration) {\n          // calculate when to fire the time based events (now that duration is known)\n          timeEvents = {\n            firstQuartile: videoEl.duration / 4,\n            midPoint: videoEl.duration / 2,\n            thirdQuartile: (videoEl.duration / 4) * 3,\n          }\n          Log.info('Ad', 'Calculated quartiles times', { timeEvents })\n        }\n        if (\n          timeEvents &&\n          timeEvents.firstQuartile &&\n          videoEl.currentTime >= timeEvents.firstQuartile\n        ) {\n          fireOnConsumer('FirstQuartile', ad)\n          delete timeEvents.firstQuartile\n          sendBeacon(ad.callbacks, 'firstQuartile')\n        }\n        if (timeEvents && timeEvents.midPoint && videoEl.currentTime >= timeEvents.midPoint) {\n          fireOnConsumer('MidPoint', ad)\n          delete timeEvents.midPoint\n          sendBeacon(ad.callbacks, 'midPoint')\n        }\n        if (\n          timeEvents &&\n          timeEvents.thirdQuartile &&\n          videoEl.currentTime >= timeEvents.thirdQuartile\n        ) {\n          fireOnConsumer('ThirdQuartile', ad)\n          delete timeEvents.thirdQuartile\n          sendBeacon(ad.callbacks, 'thirdQuartile')\n        }\n      },\n      stalled() {\n        fireOnConsumer('Stalled', ad)\n        timeout = setTimeout(() => {\n          cleanup()\n        }, 5000) // make timeout configurable\n      },\n      canplay() {\n        timeout && clearTimeout(timeout)\n      },\n      error() {\n        fireOnConsumer('Error', ad)\n        cleanup()\n      },\n      // this doesn't work reliably on sky box, moved logic to timeUpdate event\n      // loadedmetadata() {\n      //   // calculate when to fire the time based events (now that duration is known)\n      //   timeEvents = {\n      //     firstQuartile: videoEl.duration / 4,\n      //     midPoint: videoEl.duration / 2,\n      //     thirdQuartile: (videoEl.duration / 4) * 3,\n      //   }\n      // },\n      abort() {\n        cleanup()\n      },\n      // todo: pause, resume, mute, unmute beacons\n    }\n    // add all listeners\n    Object.keys(handlers).forEach(handler => videoEl.addEventListener(handler, handlers[handler]))\n\n    videoEl.play()\n  })\n}\n\nconst sendBeacon = (callbacks, event) => {\n  if (callbacks && callbacks[event]) {\n    Log.info('Ad', 'Sending beacon', event, callbacks[event])\n    return callbacks[event].reduce((promise, url) => {\n      return promise.then(() =>\n        fetch(url)\n          // always resolve, also in case of a fetch error (so we don't block firing the rest of the beacons for this event)\n          // note: for fetch failed http responses don't throw an Error :)\n          .then(response => {\n            if (response.status === 200) {\n              fireOnConsumer('Beacon' + event + 'Sent')\n            } else {\n              fireOnConsumer('Beacon' + event + 'Failed' + response.status)\n            }\n            Promise.resolve(null)\n          })\n          .catch(() => {\n            Promise.resolve(null)\n          })\n      )\n    }, Promise.resolve(null))\n  } else {\n    Log.info('Ad', 'No callback found for ' + event)\n  }\n}\n\nconst fireOnConsumer = (event, args) => {\n  if (consumer) {\n    consumer.fire('$ad' + event, args)\n    consumer.fire('$adEvent', event, args)\n  }\n}\n\nexport default {\n  get(config, videoPlayerConsumer) {\n    if (config.enabled === false) {\n      return Promise.resolve({\n        prerolls() {\n          return Promise.resolve()\n        },\n      })\n    }\n    consumer = videoPlayerConsumer\n\n    return new Promise(resolve => {\n      Log.info('Ad', 'Starting session')\n      getAds(config).then(ads => {\n        Log.info('Ad', 'API result', ads)\n        resolve({\n          prerolls() {\n            if (ads.preroll) {\n              state.active = true\n              fireOnConsumer('PrerollSlotImpression', ads)\n              sendBeacon(ads.preroll.callbacks, 'slotImpression')\n              return playSlot(ads.preroll.ads).then(() => {\n                fireOnConsumer('PrerollSlotEnd', ads)\n                sendBeacon(ads.preroll.callbacks, 'slotEnd')\n                state.active = false\n              })\n            }\n            return Promise.resolve()\n          },\n          midrolls() {\n            return Promise.resolve()\n          },\n          postrolls() {\n            return Promise.resolve()\n          },\n        })\n      })\n    })\n  },\n  cancel() {\n    Log.info('Ad', 'Cancel Ad')\n    state.active = false\n  },\n  stop() {\n    Log.info('Ad', 'Stop Ad')\n    state.active = false\n    // fixme: duplication\n    const videoEl = document.getElementsByTagName('video')[0]\n    videoEl.pause()\n    videoEl.removeAttribute('src')\n  },\n}\n","/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2020 Metrological\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Lightning from '../Lightning'\n\nexport default class ScaledImageTexture extends Lightning.textures.ImageTexture {\n  constructor(stage) {\n    super(stage)\n    this._scalingOptions = undefined\n  }\n\n  set options(options) {\n    this.resizeMode = this._scalingOptions = options\n  }\n\n  _getLookupId() {\n    return `${this._src}-${this._scalingOptions.type}-${this._scalingOptions.w}-${this._scalingOptions.h}`\n  }\n\n  getNonDefaults() {\n    const obj = super.getNonDefaults()\n    if (this._src) {\n      obj.src = this._src\n    }\n    return obj\n  }\n}\n","import { Lightning } from '@lightningjs/sdk'\n\nexport default class BaseScreen extends Lightning.Component {\n  show() {\n    this.visible = true\n  }\n  hide() {\n    this.visible = false\n  }\n}\n","import BaseScreen from '../BaseScreen'\n\nexport default class HomeScreen extends BaseScreen {\n  static _template() {\n    return {\n      Text: {\n        text: {\n          fontSize: 50,\n          fontFace: 'sans-serif',\n          textColor: 0xffffffff,\n          text: 'HomeScreen',\n        },\n      },\n      alpha: 0.5,\n    }\n  }\n}\n","import BaseScreen from '../BaseScreen'\n\nexport default class MoviesScreen extends BaseScreen {\n  static _template() {\n    return {\n      Caption: {\n        text: {\n          fontSize: 50,\n          fontFace: 'sans-serif',\n          textColor: 0xffffffff,\n          text: 'MoviesScreen',\n        },\n      },\n      alpha: 0.5,\n    }\n  }\n}\n","import BaseScreen from '../BaseScreen'\n\nexport default class TVShowsScreen extends BaseScreen {\n  static _template() {\n    return {\n      Text: {\n        text: {\n          fontSize: 50,\n          fontFace: 'sans-serif',\n          textColor: 0xffffffff,\n          text: 'TVShowsScreen',\n        },\n      },\n      alpha: 0.5,\n    }\n  }\n}\n","import BaseScreen from '../BaseScreen'\n\nexport default class SportsScreen extends BaseScreen {\n  static _template() {\n    return {\n      Text: {\n        text: {\n          fontSize: 50,\n          fontFace: 'sans-serif',\n          textColor: 0xffffffff,\n          text: 'SportsScreen',\n        },\n      },\n      alpha: 0.5,\n    }\n  }\n}\n","import HomeScreen from '../screens/HomeScreen'\nimport MoviesScreen from '../screens/MoviesScreen'\nimport TVShowsScreen from '../screens/TVShowsScreen'\nimport SportsScreen from '../screens/SportsScreen'\n\nexport const routings = [\n  {\n    url: 'home',\n    settings: {\n      type: HomeScreen,\n      ref: 'HomeScreen',\n      x: 68,\n      y: 150,\n      w: 1920 - 68 * 2,\n    },\n  },\n  {\n    url: 'movies',\n    settings: {\n      type: MoviesScreen,\n      ref: 'MoviesScreen',\n      x: 68,\n      y: 150,\n      w: 1920 - 68 * 2,\n    },\n  },\n  {\n    url: 'shows',\n    settings: {\n      type: TVShowsScreen,\n      ref: 'TVShowsScreen',\n      x: 68,\n      y: 150,\n      w: 1920 - 68 * 2,\n    },\n  },\n  {\n    url: 'sports',\n    settings: {\n      type: SportsScreen,\n      ref: 'SportsScreen',\n      x: 68,\n      y: 150,\n      w: 1920 - 68 * 2,\n    },\n  },\n]\n","import { routings } from './RoutingMap'\nlet application = null\nlet stage = null\nlet host = null\nlet activeScreen = null\nconst screenCache = {}\n\n/**\n * setup parameters\n * @param instance - {application instance}\n */\nexport const setupRouter = instance => {\n  application = instance\n  stage = application.stage\n}\n/**\n * current opened screen\n * @return activeScreen - {component}\n */\nexport const getActiveScreen = () => {\n  return activeScreen\n}\n/**\n * navigate to screen\n * @param route - {string}\n */\nexport const navigate = route => {\n  const routing = routings.find(r => r.url === route)\n  if (!host && application.childList.getByRef('App')) {\n    const node = application.childList.getByRef('App')\n    host = node.childList\n  }\n  if (!routing || (activeScreen && route === activeScreen.ref)) {\n    return\n  }\n  if (activeScreen) {\n    activeScreen.hide()\n  }\n  // eslint-disable-next-line no-prototype-builtins\n  if (!screenCache.hasOwnProperty(routing.url)) {\n    screenCache[routing.url] = createScreen(routing.settings)\n  }\n  activeScreen = screenCache[routing.url]\n  activeScreen.show()\n}\nconst createScreen = settings => {\n  const component = stage.c(settings)\n  host.a(component)\n  return component\n}\n","import { Lightning } from '@lightningjs/sdk'\nimport { navigate } from './Router'\n\nexport default class NavigationItem extends Lightning.Component {\n  _handleEnter() {\n    console.log('ENTER IS WORKING')\n    if (this._route) {\n      navigate(this._route)\n    }\n  }\n}\n","// import { Lightning } from '@lightningjs/sdk'\nimport NavigationItem from '../../lib/NavigationItem'\n\nexport default class HeaderItem extends NavigationItem {\n  static _template() {\n    return {\n      flexItem: { marginLeft: 100, alpha: 0.5 },\n      Text: {},\n    }\n  }\n  set item(value) {\n    this.tag('Text').patch({\n      text: value,\n      fontSize: 36,\n      fontFace: 'sans-serif',\n      textColor: 0xffffffff,\n      textAlign: 'center',\n      // route: this.tag('Text').toLowerCase(),\n      // route: value.toLowerCase(),\n    })\n    this._text = value\n    this._route = value.route.toLowerCase()\n  }\n  get item() {\n    return this._text\n  }\n  _focus() {\n    this.color = 0xffff0000\n    this.tag('Text').color = 0xff1f1f1f\n    // this.setSmooth('alpha', 1)\n    // this.tag('Text').setSmooth('color', '0xffff00ff')\n  }\n  _unfocus() {\n    this.color = 0xffffffff\n    this.tag('Text').color = 0xffffffff\n    // this.setSmooth('alpha', 0.5)\n    // this.tag('Text').setSmooth('color', '0xffffffff')\n  }\n}\n","import { Lightning, Utils } from '@lightningjs/sdk'\nimport HeaderItem from './HeaderItem'\n// import NavigationItem from '../lib/NavigationItem'\n\nconst itemData = ['Home', 'Movies', 'TV', 'Sports']\n\nexport default class Header extends Lightning.Component {\n  static _template() {\n    return {\n      Header: {\n        flex: {\n          direction: 'row',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          wrap: false,\n        },\n        rect: true,\n        w: 1920,\n        h: 144,\n        color: 0xff0099f7,\n\n        //Logo, ex. EPAM\n        ShadowsLogo: {\n          x: 20,\n          y: 20,\n          flexItem: { marginLeft: 55 },\n          zIndex: 1,\n          color: 0x66000000,\n          texture: Lightning.Tools.getShadowRect(110, 60, 4, 10, 10),\n          Logo: {\n            w: 100,\n            h: 50,\n            src: Utils.asset('images/header/EPAM_logo.png'),\n            zIndex: 2,\n          },\n        },\n\n        //central block\n\n        // Old solution\n        // Home: {\n        //   flexItem: { marginLeft: 500 },\n        //   text: {\n        //     text: 'HOME',\n        //     fontSize: 36,\n        //     fontFace: 'sans-serif',\n        //     textColor: 0xffffffff,\n        //   },\n        // },\n        // Movies: {\n        //   flexItem: { marginLeft: 67 },\n        //   text: {\n        //     text: 'MOVIES',\n        //     fontSize: 36,\n        //     fontFace: 'sans-serif',\n        //     textColor: 0xffffffff,\n        //   },\n        // },\n        // Tv: {\n        //   flexItem: { marginLeft: 58 },\n        //   text: {\n        //     text: 'TV',\n        //     fontSize: 36,\n        //     fontFace: 'sans-serif',\n        //     textColor: 0xffffffff,\n        //   },\n        // },\n        // Sports: {\n        //   flexItem: { marginLeft: 64 },\n        //   text: {\n        //     text: 'SPORTS',\n        //     fontSize: 36,\n        //     fontFace: 'sans-serif',\n        //     textColor: 0xffffffff,\n        //   },\n        // },\n\n        CentralBlock: {\n          flex: { direction: 'row', alignItems: 'center' },\n        },\n\n        //End block 'search and sign In'\n        EndBlock: {\n          flex: { direction: 'row', alignItems: 'flex-end' },\n          Search: {\n            w: 49,\n            h: 50,\n            flexItem: { marginLeft: 200 },\n            src: Utils.asset('images/header/search.png'),\n          },\n          SignIn: {\n            w: 168,\n            h: 68,\n            flexItem: { marginLeft: 45, marginRight: 75 },\n            src: Utils.asset('images/header/img_signIn.png'),\n            TextSignIn: {\n              mountX: -0.35,\n              mountY: -0.3,\n              text: {\n                text: 'Sign in',\n                fontSize: 32,\n                fontFace: 'sans-serif',\n                textColor: 0xffffffff,\n              },\n            },\n          },\n        },\n      },\n    }\n  }\n\n  _init() {\n    this.index = 0\n    this._setState('Focus')\n    this.tag('CentralBlock').children = itemData.map(item => {\n      return {\n        type: HeaderItem,\n        text: item.toUpperCase(),\n        // route: item.toLowerCase(),\n        // flexItem: { marginBottom: 30 },\n      }\n    })\n  }\n\n  static _states() {\n    return [\n      class Focus extends this {\n        _getFocused() {\n          return this.tag('CentralBlock').children[this.index]\n        }\n        _handleLeft() {\n          if (this.index > 0) {\n            this.index--\n          }\n        }\n        _handleRight() {\n          // we don't know exactly how many items the list can have\n          // so we test it based on this component's child list\n          if (this.index < this.tag('CentralBlock').children.length - 1) {\n            this.index++\n          }\n        }\n        reset() {\n          this.index = 0\n          this._refocus() // We need to force focus recalc.\n        }\n      },\n    ]\n  }\n}\n","import { Lightning, Utils } from '@lightningjs/sdk'\n// import { LightningElement } from 'lwc'\n\nexport default class Slider extends Lightning.Component {\n  static getFonts() {\n    return [{ family: 'DejaVu Sans', url: Utils.asset('fonts/DejaVuSans.ttf') }]\n  }\n\n  static _template() {\n    return {\n      ImageDeadpool: {\n        y: h => h + 144,\n        w: 1920,\n        h: 638,\n        src: Utils.asset('../../static/images/slider/Deadpool.png'),\n\n        Shadow: {\n          // y: h => h - 300,\n          w: w => w,\n          h: 640,\n          src: Utils.asset('../../static/images/slider/DeadpoolShadow.png'),\n        },\n\n        TextDeadpool: {\n          x: 159,\n          y: 436,\n          text: {\n            text: 'Deadpool',\n            fontSize: 101,\n            fontFace: 'sans-serif',\n            fontStyle: 'bold',\n            textColor: 0xffffffff,\n          },\n        },\n\n        TextSmall: {\n          x: 154,\n          y: 553,\n          text: {\n            text: 'Options can be contextual to the screen and/or the screen item in focus',\n            fontSize: 27,\n            fontFace: 'sans-serif',\n            textColor: 0xffffffff,\n          },\n        },\n      },\n    }\n  }\n  _focus() {\n    this.color = 0xffff0000\n    this.tag('ImageDeadpool').color = 0xffff00ff\n    // this.setSmooth('alpha', 1)\n    // this.tag('Text').setSmooth('color', '0xffff00ff')\n  }\n  _unfocus() {\n    this.color = 0xffffffff\n    this.tag('ImageDeadpool').color = 0xffffffff\n    // this.setSmooth('alpha', 0.5)\n    // this.tag('Text').setSmooth('color', '0xffffffff')\n  }\n}\n\n// <div class=\"slider\">\n// <div class=\"slider-line\">\n//     <img src=\"./images/elephant.png\" alt=\"\">\n//     <img src=\"./images/gorilla.png\" alt=\"\">\n//     <img src=\"./images/home.png\" alt=\"\">\n//     <img src=\"./images/ice_cream.png\" alt=\"\">\n// </div>\n// </div>\n// <button class=\"slider-prev\">Prev</button>\n// <button class=\"slider-next\">Next</button>\n\n// let offset = 0;\n// const sliderLine = document.querySelector('.slider-line');\n\n// document.querySelector('.slider-next').addEventListener('click', function(){\n//     offset = offset + 256;\n//     if (offset > 768) {\n//         offset = 0;\n//     }\n//     sliderLine.style.left = -offset + 'px';\n// });\n\n// document.querySelector('.slider-prev').addEventListener('click', function () {\n//     offset = offset - 256;\n//     if (offset < 0) {\n//         offset = 768;\n//     }\n//     sliderLine.style.left = -offset + 'px';\n// })\n","import { Lightning, Utils } from '@lightningjs/sdk'\n\nexport default class Movies extends Lightning.Component {\n  static getFonts() {\n    return [{ family: 'DejaVu Sans', url: Utils.asset('fonts/DejaVuSans.ttf') }]\n  }\n\n  static _template() {\n    return {\n      Text: {\n        x: 98,\n        y: 785,\n        text: {\n          text: 'New Movie',\n          fontSize: 39,\n          fontFace: 'sans-serif',\n          textColor: 0xffffffff,\n        },\n        Movies: {\n          flex: { direction: 'row', justifyContent: 'space-between', wrap: false },\n          Movie1: {\n            flexItem: { marginLeft: 20 },\n            y: 53,\n            w: 277,\n            h: 416,\n            src: Utils.asset('../../static/images/movies/1.png'),\n          },\n          Movie2: {\n            flexItem: { marginLeft: 20 },\n            y: 53,\n            w: 277,\n            h: 416,\n            src: Utils.asset('../../static/images/movies/2.png'),\n          },\n          Movie3: {\n            flexItem: { marginLeft: 20 },\n            y: 53,\n            w: 277,\n            h: 416,\n            src: Utils.asset('../../static/images/movies/3.png'),\n          },\n          Movie4: {\n            flexItem: { marginLeft: 20 },\n            y: 53,\n            w: 277,\n            h: 416,\n            src: Utils.asset('../../static/images/movies/4.png'),\n          },\n          Movie5: {\n            flexItem: { marginLeft: 20 },\n            y: 53,\n            w: 277,\n            h: 416,\n            src: Utils.asset('../../static/images/movies/5.png'),\n          },\n          Movie6: {\n            flexItem: { marginLeft: 20 },\n            y: 53,\n            w: 277,\n            h: 416,\n            src: Utils.asset('../../static/images/movies/6.png'),\n          },\n          Movie7: {\n            flexItem: { marginLeft: 20 },\n            y: 53,\n            w: 277,\n            h: 416,\n            src: Utils.asset('../../static/images/movies/7.png'),\n          },\n        },\n      },\n    }\n  }\n\n  _init() {\n    this.index = 1\n    this._setState('Focus')\n  }\n\n  static _states() {\n    return [\n      class Focus extends this {\n        _getFocused() {\n          return this.tag('Movies')[this.index]\n        }\n        _handleLeft() {\n          if (this.index > 0) {\n            this.index--\n          }\n        }\n        _handleRight() {\n          // we don't know exactly how many items the list can have\n          // so we test it based on this component's child list\n          if (this.index < this.index + 1) {\n            this.index++\n          }\n        }\n      },\n    ]\n  }\n\n  _focus() {\n    this.color = 0xffffffff\n    this.tag('Movies').children[this.index].color = 0xffff00ff\n  }\n  _unfocus() {\n    this.color = 0xffffffff\n    this.tag('Movies').children[this.index].color = 0xffffffff\n  }\n}\n","import { Lightning, Utils } from '@lightningjs/sdk'\nimport Header from './components/Header/Header'\nimport Slider from './components/Slider/Slider'\nimport Movies from './components/Movies/Movies'\nimport { getActiveScreen, navigate } from './lib/Router'\n\nexport default class App extends Lightning.Component {\n  static getFonts() {\n    return [{ family: 'DejaVu Sans', url: Utils.asset('fonts/DejaVuSans.ttf') }]\n  }\n\n  static _template() {\n    return {\n      Background: {\n        rect: true,\n        w: 1920,\n        h: 1080,\n        //color black\n        color: 0xff000000,\n        // src: Utils.asset('../static/images/background.png'),\n      },\n      Header: { type: Header },\n      Slider: { type: Slider },\n      Movies: { type: Movies },\n\n      // RectangleWithColor: {\n      //   rect: true,\n      //   alpha: 0.8,\n      // x: 200,\n      // y: 100,\n      //   x: x => x + 100,\n      //   y: h => h + 80,\n      //   w: 400,\n      //   h: 200,\n      // color blue\n      //   color: 0xff1c27bc,\n    }\n  }\n\n  _init() {\n    // this.tag('Background')\n    //   .animation({\n    //     duration: 15,\n    //     repeat: -1,\n    //     actions: [\n    //       {\n    //         t: '',\n    //         p: 'color',\n    //         v: { 0: { v: 0xfffbb03b }, 0.5: { v: 0xfff46730 }, 0.8: { v: 0xfffbb03b } },\n    //       },\n    //     ],\n    //   })\n    //   .start()\n    navigate('home')\n    // this._setState('HeaderState')\n  }\n\n  static _states() {\n    return [\n      class Header extends this {\n        _getFocused() {\n          return this.tag('Header')\n        }\n      },\n      class Slider extends this {\n        _getFocused() {\n          return this.tag('Slider')\n        }\n      },\n      class Movies extends this {\n        _getFocused() {\n          return this.tag('Movies')\n        }\n      },\n      class Screen extends this {\n        _getFocused() {\n          return getActiveScreen()\n        }\n      },\n    ]\n  }\n  _getFocused() {\n    return this.tag('Header')\n  }\n  _handleKey(key) {\n    if (key.code === 'Backspace') {\n      const activeScreen = getActiveScreen()\n      if (!activeScreen || activeScreen.ref === 'HomeScreen') {\n        return false\n      } else {\n        navigate('home')\n        return true\n      }\n    }\n\n    if (key.code === 'ArrowDown') {\n      this._setState('Slider')\n\n      return true\n    }\n    if (key.code === 'ArrowDown' && this.tag('Slider')) {\n      this._setState('Movies')\n\n      return true\n    }\n\n    if (key.code === 'ArrowUp') {\n      this._setState('Header')\n\n      return true\n    }\n\n    return false\n  }\n}\n","import { Launch } from '@lightningjs/sdk'\nimport App from './App.js'\nimport { setupRouter } from './lib/Router'\n// import Splash from './Splash'\n\nexport default function() {\n  const app = Launch(App, ...arguments)\n  setupRouter(app)\n  return app\n}\n"],"names":["settings","subscribers","initSettings","appSettings","platformSettings","publish","key","value","forEach","subscriber","dotGrab","obj","undefined","keys","split","i","length","Object","get","type","fallback","val","has","set","subscribe","callback","push","unsubscribe","index","findIndex","cb","splice","clearSubscribers","getOwnPropertyNames","prepLog","args","colors","Info","Debug","Warn","Error","Array","from","shift","info","Settings","console","log","apply","arguments","debug","error","warn","method","context","result","e","then","Promise","resolve","reject","sendMetric","event","params","Log","initMetrics","config","metrics","app","page","user","media","errorMetric","message","code","visible","Metric","events","options","reduce","name","Metrics","types","url","abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","timeupdate","volumechange","waiting","sourceObject","setup","ready","doSetup","getOwnPropertyDescriptor","__defineGetter__","__defineSetter__","timeout","delay","clearTimeout","setTimeout","basePath","proxyUrl","initUtils","ensureUrlWithProtocol","makeFullStaticPath","window","location","pathname","path","asset","relPath","makeQueryString","test","protocol","origin","charAt","cleanUpPathName","substr","slice","parts","indexOf","pop","join","operator","map","encodeURIComponent","initProfile","lng","mediaUrl","initMediaPlayer","Mediaplayer","Lightning","Component","_construct","_skipRenderToTexture","_metrics","_textureMode","_template","Video","VideoWrap","VideoTexture","pivot","texture","textures","StaticTexture","skipRenderToTexture","v","textureMode","videoView","tag","_init","videoEls","document","getElementsByTagName","videoEl","createElement","setAttribute","style","position","zIndex","display","visibility","body","appendChild","_createVideoTexture","eventHandlers","_registerListeners","handler","currentTime","fire","videoElement","addEventListener","_deregisterListeners","removeEventListener","_attach","_detach","close","stage","gl","glTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","videoTexture","source","w","width","h","height","_startUpdatingVideoTexture","_updateVideoTexture","videoWidth","active","Date","getTime","frameCount","webkitDecodedFrameCount","mustUpdate","_lastFrame","_lastTime","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texImage2D","RGBA","UNSIGNED_BYTE","videoTextureView","videoHeight","expectedAspectRatio","realAspectRatio","scaleX","scaleY","_stopUpdatingVideoTexture","forceRenderUpdate","_updatingVideoTexture","on","removeListener","clearColor","clear","COLOR_BUFFER_BIT","updateSettings","_consumer","consumer","getMediaplayerSettings","assign","Utils","equalValues","_stream","stream","keySystem","navigator","requestMediaKeySystemAccess","id","keySystemAccess","createMediaKeys","createdMediaKeys","setMediaKeys","src","open","catch","Hls","isSupported","_hls","liveDurationInfinity","loadSource","attachMedia","_setHide","hide","_setVideoArea","videoPos","setSmooth","videoPosition","application","noVideo","getAttribute","removeAttribute","load","_clearSrc","playPause","isPlaying","doPause","doPlay","muted","loop","_getState","reload","getPosition","setPosition","pos","getDuration","duration","seek","time","absolute","_videoPos","patch","smooth","x","y","precision","getRenderPrecision","left","Math","round","top","_fireConsumer","_equalInitData","buf1","buf2","byteLength","dv1","Int8Array","dv2","_setState","video","mediaKeys","_previousInitData","initData","_states","Playing","$enter","$exit","Paused","localCookie","constructor","forceCookies","_checkIfLocalStorageWorks","getItem","_getItemLocalStorage","setItem","_setItemLocalStorage","removeItem","_removeItemLocalStorage","_clearLocalStorage","_getItemCookie","_setItemCookie","_removeItemCookie","_clearCookies","localStorage","t","cookie","match","RegExp","replace","o","r","toUTCString","initStorage","namespace","lc","hasRegex","isWildcard","hasLookupId","isNamedGroup","stripRegex","route","char","createRegister","flags","reg","Map","getOwnPropertySymbols","Request","hash","navArgs","storeCaller","_hash","_storeCaller","_register","_isCreated","_isSharedInstance","_cancelled","_copiedHistoryState","isObject","isBoolean","symbols","store","cancel","register","_route","provider","_provider","providerType","_providerType","_page","isCreated","isSharedInstance","isCancelled","copiedHistoryState","Route","acc","isFunction","_cfg","request","component","widgets","cache","hook","beforeNavigate","getFloor","getRoutesByFloor","floor","matches","routes","entries","getRouteByHash","getUrlParts","candidates","hashParts","regexStore","filter","isMatching","regMatches","fullRoute","regex","lookupId","substring","routeParts","j","routePart","hashPart","routeMatches","exec","storeId","routeRegex","expression","modifiers","toLowerCase","sort","a","routeExists","getValuesFromHash","getNamedGroup","storage","decodeURIComponent","getOption","stack","prop","hasOwnProperty","createRoute","preventStorage","bootRequest","after","createRequest","getHashByName","to","getRouteByName","hasDynamicGroup","query","objectToQueryString","keepActivePageAlive","isString","getRoutes","routeOptions","keepAlive","isArray","ucfirst","activeWidget","getReferences","widgetsHost","widget","ref","updateWidgets","configured","emit","state","getWidgetByName","getByRef","focusWidget","setActiveWidget","restoreFocus","getActiveWidget","instance","createComponent","c","history","updateHistory","getActiveHash","forceNavigateStore","activeRoute","toStore","locationInHistory","stateObject","getStateObject","getActivePage","routerConfig","getRouterConfig","prev","getHistoryState","record","replaceHistoryState","historyState","getHistory","setHistory","arr","isMergeableObject","isNonNullObject","isSpecial","stringValue","prototype","toString","call","isReactElement","canUseSymbol","Symbol","for","REACT_ELEMENT_TYPE","$$typeof","emptyTarget","cloneUnlessOtherwiseSpecified","clone","deepmerge","defaultArrayMerge","target","concat","element","getMergeFunction","customMerge","getEnumerableOwnPropertySymbols","symbol","propertyIsEnumerable","getKeys","propertyIsOnObject","object","property","_","propertyIsUnsafe","mergeObject","destination","arrayMerge","sourceIsArray","targetIsArray","sourceAndTargetTypesMatch","all","deepmergeAll","array","next","deepmerge_1","cjs","warned","deprecated","force","Locale","__enabled","fetch","resp","json","loadFromObject","setLanguage","lang","language","tr","__trObj","trObj","fallbackLanguage","values","str","LocalizedString","String","format","sub","string","arg","VersionLabel","rect","color","mount","Text","text","fontSize","lineHeight","_firstActive","version","sdkVersion","loadTexture","renderWidth","renderHeight","FpsIndicator","Tools","getRoundRect","Background","Counter","textAlign","_setup","interval","threshold","fps","lastFps","fpsCalculator","dt","off","setInterval","showFps","bind","clearInterval","abs","bgColor","meta","translations","initLanguage","file","response","setTranslations","default","translationsObj","registry","eventListeners","timeouts","intervals","targets","timeoutId","clearTimeouts","intervalId","clearIntervals","targetIndex","fn","removeEventListeners","_event","white","black","red","green","blue","yellow","cyan","magenta","normalizedColors","addColors","colorsToAdd","cleanUpNormalizedColors","initColors","AppInstance","defaultOptions","canvas2d","defaultFontFace","innerHeight","customFontFaces","fontLoader","fonts","family","urls","descriptors","fontFace","FontFace","add","promise","App","appData","Application","Deepmerge","loadFonts","getFonts","locale","getLocale","loadLanguage","loadColors","loaded","forceZIndexContext","showVersion","childList","_refocus","FpsCounter","_handleBack","closeApp","_handleExit","onClose","Registry","remove","cleanupFonts","gc","destroy","delete","focus","_focussed","_getFocused","pagesHost","rootHash","updateHash","beforeEachRoute","afterEachRoute","components","initialised","activePage","activeHash","lastAcceptedHash","previousState","mixin","pages","children","step","preventDefault","bootRouter","appInstance","isPage","getConfigMap","init","cleanHash","isComponentConstructor","root","boot","bootComponent","storeComponent","getComponent","mustUpdateLocationHash","size","updateConfig","onRequestResolved","cleanUp","setActivePage","navigateQueue","lazyDestroy","destroyOnBack","isFromHistory","backtrack","doCleanup","_routedType","scale","alpha","getActiveRoute","getLastHash","setLastHash","getPreviousState","getRootHash","getBootRequest","Element","toUpperCase","isPromise","routerSettings","isObj","getQueryStringParams","resumeHash","getResumeHash","parse","getQuery","search","hashParams","urlParams","URLSearchParams","fromHistory","expires","resume","queryParams","dataHooks","execProvider","before","emitProvided","addPersistData","now","urlValues","pageData","k","persist","isPageExpired","hasProvider","getProvider","fade","transition","crossFade","moveOnAxes","axis","direction","bounds","up","down","right","executeTransition","pageIn","pageOut","pageTransition","easing","hasCustomTransitions","smoothIn","smoothInOut","transitionsDisabled","Transitions","p","expired","loader","handleError","isConstruct","provide","mustReuse","currentRoute","loadType","navigate","opt","RoutedApp","Pages","Loading","Label","Widgets","_widget","_handleKey","Router","focusPage","forcedHash","startRouter","registerListener","start","getHash","bootKey","isDirectLoad","res","queue","handleHashChange","failedHash","handleBootError","setHash","override","queueId","resolveHashChange","contents","module","level","isNaN","_handleAppClose","hashLastPart","isNavigating","isProcessing","initRouter","go","back","setupRoutes","defaultChannels","number","description","entitled","program","title","startTime","ageRating","channels","randomChannel","random","currentChannel","callbacks","methods","getChannel","channel","getProgram","setChannel","newChannel","find","initTV","initPurchase","billingUrl","PinInput","shader","shaders","RoundedRectangle","radius","Nr","textColor","verticalAlign","nr","_timeout","PinDialog","Dialog","Msg","Code","pin","_pin","maskedPin","max","fill","msg","_msg","parseInt","Pin","_handleEnter","submit","unlocked","contextItems","check","initPin","pinDialog","contextCheck","includes","show","ApplicationInstance","child","locked","plugins","profile","mediaPlayer","initVideoPlayer","ads","initAds","router","tv","purchase","_videoEl","isVisible","getVideoPlaybackQuality","totalVideoFrames","stop","adsEnabled","_playingAds","playingAds","fireOnConsumer","skipTime","playAfterSeek","hooks","videoPlayerPlugin","deregisterEventListeners","withPrecision","fireHook","customLoader","customUnloader","unloader","setupVideoTag","setUpVideoTexture","el","addAt","registerEventListeners","loaderFn","unloaderFn","parseFloat","area","bottom","canInteract","adConfig","enabled","videoId","caid","Ads","prerolls","executeAsPromise","mute","looped","min","skip","seconds","easeExecution","enableAds","Infinity","autoSetupMixin","getAds","midrolls","postrolls","playSlot","slot","ad","playAd","timeEvents","cleanup","handlers","sendBeacon","firstQuartile","midPoint","thirdQuartile","status","videoPlayerConsumer","preroll","ScaledImageTexture","ImageTexture","_scalingOptions","resizeMode","_getLookupId","_src","getNonDefaults","BaseScreen","HomeScreen","MoviesScreen","Caption","TVShowsScreen","SportsScreen","routings","host","activeScreen","screenCache","setupRouter","getActiveScreen","routing","node","createScreen","NavigationItem","HeaderItem","flexItem","marginLeft","item","_text","_focus","_unfocus","itemData","Header","flex","justifyContent","alignItems","wrap","ShadowsLogo","getShadowRect","Logo","CentralBlock","EndBlock","Search","SignIn","marginRight","TextSignIn","mountX","mountY","Focus","_handleLeft","_handleRight","reset","Slider","ImageDeadpool","Shadow","TextDeadpool","fontStyle","TextSmall","Movies","Movie1","Movie2","Movie3","Movie4","Movie5","Movie6","Movie7","Screen","Launch"],"mappings":"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"}